---
layout: article
title: Shape Analysis课程笔记10-Distance Metrics and Embeddings
tags: ["Shape Analysis", "Geometry Processing", "CG"]
key: SA-10
aside:
  toc: true
sidebar:
  nav: SA
---

> 这个系列是[MIT 6.838: Shape Analysis](https://groups.csail.mit.edu/gdpgroup/6838_spring_2021.html)的同步课程笔记。本课程会介绍几何方法在图形学、机器学习、计算机视觉、医疗图像以及建筑设计等相关领域的原理和应用。本节主要介绍度量空间的相关概念。
<!--more-->

在上一章节中我们介绍了测地线和测地距离的相关概念，而在这一章节我们会考虑它的逆问题，即已知样本点之间的距离然后恢复它们本身的几何。这一问题也称为**inverse distance problem**。

<div align=center>
<img src="https://i.imgur.com/Ac6tWJX.png" width="80%">
<img src="https://i.imgur.com/QLAu2C0.png" width="80%">
</div>

实际上这样的问题不仅在几何处理中有大量的应用，在机器学习等相关领域中也同样有着重要的意义。

<div align=center>
<img src="https://i.imgur.com/VFOa37v.png" width="80%">
</div>

具体来说，我们的基本目标是在给定样本之间距离的基础上计算一个样本的**嵌入(embedding)**。

<div align=center>
<img src="https://i.imgur.com/BUp6W68.png" width="80%">
</div>

## Metric Space

我们先来介绍一下**度量空间(metric space)**的概念。在集合$M$上赋予一个距离函数$d$就得到了度量空间，当然这个距离函数$d$需要满足一些性质：

- **非负性(non-negativity)**：$d(x, y) \geq 0$
- **同一性**：$d(x, y) = 0 \Leftrightarrow x = y$
- **对称性(symmetry)**：$d(x, y) = d(y, x)$
- **三角不等式(triangle inequality)**：$d(x, z) \leq d(x, y) + d(y, z)$

<div align=center>
<img src="https://i.imgur.com/WkMN9in.png" width="80%">
</div>

除了我们常见的欧式空间外，定义了测地距离的流形以及$C^\infty(\mathbb{R})$的函数空间都是度量空间。

<div align=center>
<img src="https://i.imgur.com/424dIfp.png" width="80%">
</div>

## Embedding a Metric Space

由于度量空间是非常丰富的，在实践中我们更关心如何把一个广义上的度量空间映射到一个方便进行处理的空间(如欧式空间)上。如果存在一个映射能够将沟通两个度量空间，而且保证映射前后样本之间的距离是不变的，则称这样的一个映射是**等距(isometry)**的。

<div align=center>
<img src="https://i.imgur.com/m9OOe5h.png" width="80%">
</div>

显然我们希望可以把一个任意的度量空间通过等距映射变换到欧式空间上。不过遗憾的是这基本是不可能的，即使是有限度量空间也不能保证一定可以通过等距映射转换为欧式空间。

<div align=center>
<img src="https://i.imgur.com/qDulMvr.png" width="80%">
</div>

但对于有限度量空间可以证明存在等距映射将样本嵌入到某个由无穷范数定义的欧式空间$l_\infty(\mathbb{R}^n)$上。

<div align=center>
<img src="https://i.imgur.com/4dSVF0X.png" width="80%">
</div>

下面我们简单证明一下上面的结论。假设存在有限度量空间$(M, d)$，其中$M = \{ a_1, a_2, ..., a_n \}$。接下来定义映射$\phi: M \rightarrow \mathbb{R}^n$为：

$$
\phi(a_k) = \big( d(a_1, a_k), d(a_2, a_k), ..., d(a_n, a_k) \big)
$$

不难证明$\phi$是一个等距映射。首先考虑映射后$\phi(a_i)$和$\phi(a_j)$之间的距离：

$$
\Vert \phi(a_i) - \phi(a_j) \Vert_\infty = \max_k \vert d(a_i, a_k)- d(a_j, a_k) \vert
$$

对于右边有：

$$
\begin{aligned}
\max_k \vert d(a_i, a_k)- d(a_j, a_k) \vert &\geq \vert d(a_i, a_i)- d(a_j, a_i) \vert \\
&= d(a_i, a_j)
\end{aligned}
$$

同时根据三角不等式有对于$\forall k$满足：

$$
d(a_i, a_k) \leq d(a_i, a_j) + d(a_j, a_k) \Leftrightarrow d(a_i, a_k) - d(a_j, a_k) \leq d(a_i, a_j)
$$

$$
d(a_j, a_k) \leq d(a_j, a_i) + d(a_i, a_k) \Leftrightarrow  d(a_j, a_k) - d(a_i, a_k) \leq d(a_i, a_j)
$$

即

$$
\vert d(a_i, a_k) - d(a_j, a_k) \vert \leq d(a_i, a_j)
$$

$$
\max_k \vert d(a_i, a_k) - d(a_j, a_k) \vert \leq d(a_i, a_j)
$$

综合上面的推导可以得到：

$$
d(a_i, a_j) \leq \max_k \vert d(a_i, a_k) - d(a_j, a_k) \vert \leq d(a_i, a_j)
$$

$$
\max_k \vert d(a_i, a_k) - d(a_j, a_k) \vert = d(a_i, a_j)
$$

即原始度量空间$M$可以通过等距映射$\phi$变换到$l_\infty(\mathbb{R}^n)$上。

<div align=center>
<img src="https://i.imgur.com/7DBu8Bz.png" width="80%">
</div>

## Approximate Embedding

## Reference

- [Lecture 10：Metric spaces and embeddings](https://www.youtube.com/watch?v=gxOohqi2l0g&list=PLQ3UicqQtfNtUcdTMLgKSTTOiEsCw2VBW&index=13&ab_channel=JustinSolomon)
- [Lecture 10, part2：Algorithms for embedding into Euclidean space](https://www.youtube.com/watch?v=x1R2vxNGG18&list=PLQ3UicqQtfNtUcdTMLgKSTTOiEsCw2VBW&index=14&ab_channel=JustinSolomon)
- [Chapter 7：Inverse distance problems](https://groups.csail.mit.edu/gdpgroup/assets/6838_spring_2021/chapter7.pdf)