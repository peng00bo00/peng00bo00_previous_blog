---
layout: article
title: GAMES001课程笔记06-傅里叶变换与球谐函数
tags: ["CG", "GAMES001", "Math"]
key: GAMES001-06
aside:
  toc: true
sidebar:
  nav: GAMES001
---

> 这个系列是GAMES001-图形学中的数学([GAMES 001: Mathematics in Computer Graphics](https://games-cn.org/games001/))的同步课程笔记。课程旨在总结归纳图形学学习过程中重要的数学概念、理论和方法，并将以索引的形式在每一章节中穿插讲解该数学专题在图形学中的应用。本课程既可以作为GAMES系列其它课程学习的基础或"手册"，也可以作为站在不一样的视角复习图形学知识的平台。本节主要介绍谱变换的相关技术。
<!--more-->

## 傅里叶变换

### 傅里叶展开

傅里叶变换的基础是傅里叶展开。对于任意的周期函数$$f$$，我们可以使用一系列周期(频率)不同的正弦、余弦函数来对它进行近似。通过调整这些基函数的权重系数，我们可以恢复原始的周期函数$$f$$。

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/g3OuiPK.png" width="100%">
</div>

实际上基函数的权重系数对应它们的振幅，因此我们可以把这些基函数的振幅和频率画在一张图上，这样就得到了原始周期函数$$f$$的**频谱(frequency spectrum)**。

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/GFc5J5H.png" width="100%">
</div>

从更数学的角度来看，傅里叶展开指出周期函数$$f(t)$$可以表示为一系列频率不同的正弦、余弦函数的线性组合：

$$
f(t) = \frac{a_0}{2} + \sum_{n=1}^\infty a_n \cos{(n \omega t)} + b_n \sin{(n \omega t)}
$$

其中频率$$\omega$$以及系数$$a_n$$和$$b_n$$由下列公式给出

$$
\begin{cases}
\begin{aligned}
\omega &= \frac{2 \pi}{T} \\
a_n &= \frac{2}{T} \int_{-\frac{T}{2}}^\frac{T}{2} f(t) \cos{(n \omega t)} \ \mathrm{d} t \\
b_n &= \frac{2}{T} \int_{-\frac{T}{2}}^\frac{T}{2} f(t) \sin{(n \omega t)} \ \mathrm{d} t \\
\end{aligned}
\end{cases}
$$

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/rf49yRg.png" width="100%">
</div>

更进一步，我们可以利用[Euler公式](https://en.wikipedia.org/wiki/Euler%27s_formula)把正弦和余弦函数写成复数的指数函数，这样就能够得到傅里叶展开更统一的指数形式：

$$
f(t) = \sum_{n = -\infty}^\infty c_n e^{i n \omega t}
$$

$$
c_n = \frac{1}{T} \int_{-\frac{T}{2}}^\frac{T}{2} f(t) e^{-i n \omega t} \ \mathrm{d} t
$$

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/d0BV6JM.png" width="100%">
</div>

### 理解傅里叶变换

对于更一般的非周期函数$$f(t)$$，我们可以将其视为周期是$$\infty$$的周期函数。在此基础上可以得到任意函数的傅里叶变换公式：

$$
F(\omega) = \frac{1}{2 \pi} \int_{-\infty}^\infty f(t) e^{-i \omega t} \ \mathrm{d} t
$$

$$
f(t) = \int_{-\infty}^\infty F(\omega) e^{i \omega t} \ \mathrm{d} \omega
$$

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/oGNNLmt.png" width="100%">
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/dXfceJp.png" width="100%">
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/J0BiasV.png" width="100%">
</div>

从线性代数的角度来看，傅里叶变换可以理解为把原始函数$$f(t)$$分解到基函数$$\{ e^{i \omega t} \vert \omega \in \mathbb{R} \}$$上，频域函数$$F(\omega)$$则对应了不同基下的坐标。

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/GL9uO4H.png" width="100%">
</div>

而原始函数$$f(t)$$则可以看作是以Delta函数$$\delta (t)$$为基的向量，其定义为

$$
\delta (t) = 
\begin{cases}
\begin{aligned}
&\infty , & t = 0 \\
&0 , & t \neq 0
\end{aligned}
\end{cases}
$$

Delta函数的一个重要形状是它在整个积分域的积分为1

$$
\int_{-\infty}^\infty \delta (t) \ \mathrm{d} t = 1
$$

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/APMoqM7.png" width="100%">
</div>

利用Delta函数的积分性质可以推导出积分恒等式

$$
\int_{-\infty}^\infty f(a) \delta (t - a) \ \mathrm{d} a = f(t)
$$

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/TsYrZQH.png" width="100%">
</div>

利用积分恒等式，我们就可以把$$f(t)$$分解到基函数$$\{ \delta (t-a) \vert a \in \mathbb{R} \}$$上，函数值$$f(a)$$即为对应基下的坐标。

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/VzcoaBp.png" width="100%">
</div>

## 卷积

## 球谐函数

## Reference

- [Lecture 07: 傅里叶变换与球谐函数](https://www.bilibili.com/video/BV1MF4m1V7e3/?p=7&vd_source=7a2542c6c909b3ee1fab551277360826)