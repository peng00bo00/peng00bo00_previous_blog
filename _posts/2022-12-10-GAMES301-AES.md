---
layout: article
title: Analytic Eigensystems for Isotropic Distortion Energies论文笔记
tags: ["CG", "GAMES301", "Geometry Processing"]
key: GAMES301-16
aside:
  toc: true
sidebar:
  nav: GAMES301
---

> GAMES301-曲面参数化([GAMES 301: Surface Parameterization](http://staff.ustc.edu.cn/~renjiec/GAMES301/index.html))作业2解析与matlab实现。
<!--more-->

[*Analytic Eigensystems for Isotropic Distortion Energies*](http://www.tkim.graphics/EIGENSYSTEMS/AnalyticEigensystems.pdf)是来自Pixar动画工作室的一篇文章。这篇文章本身是用来处理变形体仿真的问题，主要贡献在于使用矩阵的不变量来描述变形能量并且推导了各向同性材料在相应能量下的解析解。除了物理仿真外，这种技术同样可以用来处理曲面参数化的问题。我们可以把初始状态的曲面想象成某种各项同性材料组成的表面，而参数化的过程相当于把这个表面展平并约束到平面上，此时曲面会通过释放变形能来降低自身的几何扭曲。这篇笔记会详细推导相关的理论并记录下我的matlab实现。

<div align=center>
<img src="https://i.imgur.com/IpAGdtr.png" width="80%">
</div>

## Background

### Deformation Gradient

三角形网格的变形可以使用一个线性函数来进行表示。具体来说，在平面上三角形的每一个顶点的位移都是其坐标的线性组合：

$$
\begin{bmatrix}
x \\ y
\end{bmatrix}
=
\begin{bmatrix}
F_{xx} & F_{xy} \\
F_{yx} & F_{xx} \\
\end{bmatrix}

\begin{bmatrix}
\bar{x} \\ \bar{y}
\end{bmatrix}
+
\begin{bmatrix}
t_x \\ t_y
\end{bmatrix}
$$

上式的矩阵形式为：

$$
\mathbf{x} = \mathbf{F} \mathbf{\bar{x}} + \mathbf{t}
$$

其中系数矩阵$\mathbf{F}$即为变形的Jacobian矩阵，也称为**变形梯度(deformation gradient)**，它描述了三角形的旋转、缩放和反射；而向量$\mathbf{t}$则描述了三角形的刚体位移。

<div align=center>
<img src="https://i.imgur.com/dcpNCyD.png" width="50%">
<img src="https://i.imgur.com/XKFSSxL.png" width="50%">
</div>

变形梯度的计算非常简单，我们只需要考虑三角形两条对应边在变形前后的线性变换即可。我们可以以$\mathbf{\bar{x}}_0$作为三角形的局部原点，此时它的两条邻边分别为：

$$
\mathbf{\bar{o}}_1 = \mathbf{\bar{x}}_1 - \mathbf{\bar{x}}_0
$$

$$
\mathbf{\bar{o}}_2 = \mathbf{\bar{x}}_2 - \mathbf{\bar{x}}_0
$$

带入变形梯度$\mathbf{F}$可以得到：

$$
\mathbf{F}
\begin{bmatrix}
\mathbf{\bar{o}}_1 \vert \mathbf{\bar{o}}_2
\end{bmatrix}
=
\begin{bmatrix}
\mathbf{o}_1 \vert \mathbf{o}_2
\end{bmatrix}
$$

$$
\mathbf{F} \mathbf{D}_m = \mathbf{D}_s
$$

因此只需要求解矩阵方程即可：

$$
\mathbf{F} = \mathbf{D}_s \mathbf{D}_m^{-1}
$$

<div align=center>
<img src="https://i.imgur.com/Q59qOZm.png" width="80%">
</div>

计算三角形从初始构形x1到新构形x2的变形梯度(Jacobian矩阵)可以使用如下`findJacobian()`函数实现。

```matlab
function J = findJacobian(x1, x2)
%% Find Jacobian matrix from rest pose x1 to new pose x2
%% each row of x1/x2 is the coordinate of the triangle vertex

Dm = (x1(2:end, :) - x1(1, :))';
Ds = (x2(2:end, :) - x2(1, :))';

%% J * Dm = Ds
J = Ds * matrixInv2x2(Dm);

end
```

### Symmetric Dirichlet Energy

### Projected Newton Method

### Vec Operator

### Algorithm Framework

## Gradient

## Hessian

## Line Search

## Results

## Reference

- [Analytic Eigensystems for Isotropic Distortion Energies](http://www.tkim.graphics/EIGENSYSTEMS/AnalyticEigensystems.pdf)
- [Analytic Eigensystems for Isotropic Distortion Energies Supplemental Material](http://www.tkim.graphics/EIGENSYSTEMS/AnalyticEigensystemsSupplement.pdf)
- [Dynamic Deformables: Implementation and Production Practicalities](https://www.tkim.graphics/DYNAMIC_DEFORMABLES/)