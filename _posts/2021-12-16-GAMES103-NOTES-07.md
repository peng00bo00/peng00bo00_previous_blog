---
layout: article
title: GAMES103课程笔记07-Linear Finite Element Method
tags: ["GAMES103", "CG"]
key: GAMES103-07
aside:
  toc: true
sidebar:
  nav: GAMES103
---

> 这个系列是GAMES103：基于物理的计算机动画入门([GAMES 103: Intro to Physics Based Animation](http://games-cn.org/games103/))的同步课程笔记。本课程是计算机动画的入门课程，着重介绍各种基于物理的动画仿真模拟技术。本节课主要介绍有限元在物理仿真中的应用。
<!--more-->

## Linear Finite Element Method

### Deformation Gradient

**线性有限元(linear FEM)**是**有限单元法(FEM)**中最基本的形式。在linear FEM中我们使用三角形网格来表示物体，并且假设三角形内部任意点的运动可以使用一个线性变换来表示：

$$
\mathbf{x} = \mathbf{F} \mathbf{X} + \mathbf{c}
$$

式中$\mathbf{F} = \frac{\partial \mathbf{x}}{\partial \mathbf{X}}$称为**变形梯度(deformation gradient)**。同时不难发现对于三角形内部的任意两点$\mathbf{X}_a$、$\mathbf{X}_b$，它们构成的矢量在变形前后满足：

$$
\mathbf{x}_{ba} = \mathbf{x}_b - \mathbf{x}_a = (\mathbf{F} \mathbf{X}_b + \mathbf{c}) - (\mathbf{F} \mathbf{X}_a + \mathbf{c}) = \mathbf{F} \mathbf{X}_{ba}
$$

<div align=center>
<img src="https://i.imgur.com/iIhyR3p.png" width="80%">
</div>

因此我们可以利用三角形的两条边来计算变形梯度：

$$
\left\{
\begin{aligned}
& \mathbf{F} \mathbf{X}_{10} = \mathbf{x}_{10} \\
& \mathbf{F} \mathbf{X}_{20} = \mathbf{x}_{20}
\end{aligned}
\right.
\Rightarrow
\mathbf{F}
\begin{bmatrix}
\mathbf{X}_{10} & \mathbf{X}_{20}
\end{bmatrix}
= 
\begin{bmatrix}
\mathbf{x}_{10} & \mathbf{x}_{20}
\end{bmatrix}
$$

$$
\mathbf{F} = 
\begin{bmatrix}
\mathbf{x}_{10} & \mathbf{x}_{20}
\end{bmatrix}
\begin{bmatrix}
\mathbf{X}_{10} & \mathbf{X}_{20}
\end{bmatrix}^{-1}
$$

这样我们就可以利用三角形在变形前后的坐标来计算变形梯度。但需要注意的一点是这样计算出的变形梯度实际上同时包含了变形和旋转：即使三角形只进行了旋转而没有发生变形，我们仍然可以计算出一个变形梯度，此时$\mathbf{F}$等价于旋转矩阵。

<div align=center>
<img src="https://i.imgur.com/KJtUSqp.png" width="75%">
</div>

### Green Strain

显然我们希望求解出的变形能够与刚体变换无关

### Forces

## Finite Volume Method

## Hyperelastic Models

## Reference

- [Lecture 7: Other Constrained Methods and Linear Finite Element Method I](https://www.bilibili.com/video/BV12Q4y1S73g?p=7)