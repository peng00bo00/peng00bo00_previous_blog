---
layout: article
title: GAMES103课程笔记05-Physics-Based Cloth Simulation
tags: ["GAMES103", "CG"]
key: GAMES103-05
aside:
  toc: true
sidebar:
  nav: GAMES103
---

> 这个系列是GAMES103：基于物理的计算机动画入门([GAMES 103: Intro to Physics Based Animation](http://games-cn.org/games103/))的同步课程笔记。本课程是计算机动画的入门课程，着重介绍各种基于物理的动画仿真模拟技术。本节课主要介绍弹簧质点系统与布料模拟。
<!--more-->

## Spring Mass System

### Ideal Spring

在正式介绍**弹簧质点系统(spring mass system)**前我们首先来回忆下弹簧的力学性质。根据胡克定律一维理想弹簧的能量和弹力可以定义为：

$$
E(x) = \frac{1}{2} k (x - L)^2
$$

$$
f(x) = -\frac{d E}{d x} = -k (x - L)
$$

其中$k$为弹簧的刚度，$L$为弹簧的原长。

<div align=center>
<img src="https://i.imgur.com/925hRUJ.png" width="40%">
</div>

而对于三维空间中的弹簧系统的内力，我们同样可以通过对系统能量求导来计算：

$$
E (\mathbf{x}) = \frac{k}{2} (\Vert \mathbf{x}_i - \mathbf{x}_j \Vert - L)^2
$$

$$
\mathbf{f}_i (\mathbf{x}) = - \nabla_i E = -k (\Vert \mathbf{x}_i - \mathbf{x}_j \Vert - L) \frac{\mathbf{x}_i - \mathbf{x}_j}{\Vert \mathbf{x}_i - \mathbf{x}_j \Vert}
$$

$$
\mathbf{f}_j (\mathbf{x}) = - \nabla_j E = -k (\Vert \mathbf{x}_j - \mathbf{x}_i \Vert - L) \frac{\mathbf{x}_j - \mathbf{x}_i}{\Vert \mathbf{x}_j - \mathbf{x}_i \Vert}
$$

<div align=center>
<img src="https://i.imgur.com/UfPLCdi.png" width="50%">
</div>

而当系统包含多个弹簧时，系统总能量等于单个弹簧的能量之和，每个点受到的弹力等于与它相连的所有弹簧内力之和：

$$
E = \sum_j \frac{k}{2} (\Vert \mathbf{x}_i - \mathbf{x}_j \Vert - L_j)^2
$$

$$
\mathbf{f}_i (\mathbf{x}) = - \nabla_i E = \sum_j -k (\Vert \mathbf{x}_i - \mathbf{x}_j \Vert - L_j) \frac{\mathbf{x}_i - \mathbf{x}_j}{\Vert \mathbf{x}_i - \mathbf{x}_j \Vert}
$$

<div align=center>
<img src="https://i.imgur.com/p4tnDsG.png" width="30%">
</div>

### Representation

使用弹簧质点系统进行布料仿真时我们需要将布料转化为弹簧构成的网络。除了要在规则的节点之间添加水平和竖直方向的弹簧外我们还需要**对角线方向(diagonal)**以及**弯曲(bending)**弹簧来抵抗布料在不同方向的拉伸和翻折，一些结构化的弹簧网络可参考下图：

<div align=center>
<img src="https://i.imgur.com/W41XsQ4.png" width="70%">
</div>

除了结构化弹簧网格外我们也可以直接使用模型的网格来作为弹簧系统，在这种情况下往后网络往往是非结构化的。需要注意的是我们还需要在网格的内部边上添加对角的弯曲弹簧以抵抗弯曲：

<div align=center>
<img src="https://i.imgur.com/mMtQ4pS.png" width="70%">
</div>

接下来的问题是如何来表示和存储弹簧网络。最直接的想法是使用列表来存储模型的顶点和三角形，然后每个三角形的三条边分别对应三根弹簧。但这种做法的缺陷在于三角网格内部的边会被重复计算，而且没有办法直接表示三角网格内的弯曲弹簧。

<div align=center>
<img src="https://i.imgur.com/FVM1hjw.png" width="80%">
</div>

因此我们需要对三角形的列表进行一些处理：首先将每个三角形用一个三元组来表示，其中前两位表示三角形的两个顶点最后一位为三角形的编号；然后我们对所有的三元组进行排序，这样同一条边对应的不同三角形会排在相邻的位置上；最后把重复的边删除掉就可以得到网格上的所有弹簧。而在删除重复边的过程中我们已经得到了网格内部的边，我们可以利用这些重复的边来构造内部的弯曲弹簧。

<div align=center>
<img src="https://i.imgur.com/2MFqF0Z.png" width="80%">
</div>

### Explicit Integration

### Implicit Integration

## Bending and Locking Issues

## Co-rotational FEM

## Reference