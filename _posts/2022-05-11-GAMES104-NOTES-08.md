---
layout: article
title: GAMES104课程笔记08-Basics of Animation Technology
tags: ["GAMES104", "CG"]
key: GAMES104-08
aside:
  toc: true
sidebar:
  nav: GAMES104
---

> 这个系列是GAMES104-现代游戏引擎：从入门到实践([GAMES 104: Modern Game Engine-Theory and Practice](https://games104.boomingtech.com/en/))的同步课程笔记。本课程会介绍现代游戏引擎所涉及的系统架构、技术点以及引擎系统相关的知识。本节课主要介绍现代游戏引擎中的动画系统。
<!--more-->

## Introduction

动画系统是游戏引擎的重要组成部分。从远古时代开始，我们的祖先就试图用各种手段让静止的画面动起来。

<div align=center>
<img src="https://i.imgur.com/Buo3S4y.png" width="80%">
</div>

直到近代，人们发现利用人眼的"视觉残留"效应可以将静止的画面产生运动的效果。这一发现构成了所有显示设备和电影动画的理论基础。

<div align=center>
<img src="https://i.imgur.com/lZIS1ca.png" width="80%">
</div>

### Animation Techniques in Film

目前游戏行业所使用的动画技术理论和经验基本都源自于电影行业对动画技术的探索。从早期的2D动画到如今大规模应用的三维动画，整个电影动画工业取得了令人瞩目的进步。

<div align=center>
<img src="https://i.imgur.com/257ecRO.png" width="80%">
</div>

早期的动画主要是由艺术家逐帧手绘来实现，而在今天基于计算机的动画模拟技术已经成为了电影工业的主流。

<div align=center>
<img src="https://i.imgur.com/zeIoC9R.png" width="80%">
</div>

### Animation Techniques in Game

回到游戏领域，早期的游戏动画都是制作者根据真实图片进行绘制来实现的，这与早期的二维动画异曲同工。

<div align=center>
<img src="https://i.imgur.com/mT3vvZt.png" width="80%">
</div>

后来随着GPU和3D游戏引擎的出现，人们开始使用计算机来直接生成游戏场景中的动画。而在今天的3A游戏大作中，结合真人动捕以及物理仿真的计算机动画已经可以以假乱真的效果。

<div align=center>
<img src="https://i.imgur.com/CQ4nPTc.png" width="80%">
</div>

### Challenges in Game Animation

和电影行业中的计算机动画相比，游戏中的动画难点之一在于游戏是一个和玩家不断互动的过程。游戏开发者很难预设玩家的行为，而且必须考虑玩家的行为与场景进行互动的结果。

<div align=center>
<img src="https://i.imgur.com/GdwwROs.png" width="80%">
</div>

同时，游戏对于实时性有着更高的需求。在很多情况下我们甚至需要考虑游戏场景中有着上万个单位同时进行运动的情况，这样大规模的计算给游戏动画系统的性能造成了巨大的挑战。

<div align=center>
<img src="https://i.imgur.com/fCEt0vQ.png" width="80%">
</div>

除此之外，玩家对于现代游戏角色的动画也提出了更高的要求。我们希望游戏角色有着更加生动的表情，同时在运动过程中的行为尽可能自然。

<div align=center>
<img src="https://i.imgur.com/qZca7Fo.png" width="80%">
</div>

本课程中我们将游戏引擎的动画系统分成两部分。本节课会介绍一些基础的动画知识，而在下一节中则会讨论一些业界更加前沿的技术。

<div align=center>
<img src="https://i.imgur.com/vBrlvCV.png" width="80%">
</div>

## 2D Animation Techniques in Games

### Sprite animation

首先我们来看游戏中二维动画的实现。二维动画是最早的游戏动画形式，直到今天仍然有很多游戏使用二维动画来进行表现。最简单的二维动画称为**sprite animation**，它是将游戏角色的行为逐帧绘制并在游戏中进行循环播放。

<div align=center>
<img src="https://i.imgur.com/n1KK0aS.png" width="80%">
</div>

为了实现更加生动的表现效果，还可以在不同的视角下对同一动作进行绘制并且在实际游戏中根据需要选择合适的动作帧进行播放。这样就可以利用2D动画实现伪3D的效果。

<div align=center>
<img src="https://i.imgur.com/hOAOwSx.png" width="80%">
</div>

在现代游戏中sprite animation仍然占有一席之地，很多游戏的特效就是通过预先渲染出的特效帧来实现的。

<div align=center>
<img src="https://i.imgur.com/Grz7N0v.png" width="80%">
</div>

### Live2D

目前虚拟主播中大范围应用的**Live2D**技术同样来自于2D动画，通过对一系列图像进行变形就可以实现非常生动的表现效果。

<div align=center>
<img src="https://i.imgur.com/S85PogN.png" width="80%">
</div>

Live2D技术的核心是把角色的各个部位分解成不同的元素，通过对每个元素进行变形来实现虚拟人物的不同动作。

<div align=center>
<img src="https://i.imgur.com/qRKSOx9.png" width="80%">
</div>

在放置不同元素时还可以通过对图层顺序的变化进一步提升表现力。

<div align=center>
<img src="https://i.imgur.com/fEsdrOi.png" width="80%">
</div>

对于每一个图元则需要事先设置好它的网格来控制形变，这样角色的不同动作就可以通过对网格控制点的运动来进行描述。

<div align=center>
<img src="https://i.imgur.com/xPYGwD4.png" width="80%">
</div>

最后根据关键帧把角色不同元素不同控制点的运动组织起来就完成了一个虚拟角色的动作。

<div align=center>
<img src="https://i.imgur.com/ZC8pYoD.png" width="80%">
</div>

## 3D Animation Techniques in Games

### Degrees of Freedom

3D动画所需的技术要比2D动画复杂一些，在介绍具体的动画技术前我们需要先复习一下相关的数学知识。三维空间中物体的运动有**自由度(degrees of freedom, DoF)**的概念，对于刚体而言描述它的运动需要3个平动和3个旋转一共6个自由度。

<div align=center>
<img src="https://i.imgur.com/mglgyzB.png" width="80%">
<img src="https://i.imgur.com/IODmWKK.png" width="80%">
</div>

### Rigid Hierarchical Animation

最简单的3D动画技术是把角色的不同部位都视为刚体，然后按照一定的层次把它们组织起来。早期的3D游戏就是使用这样的方法来实现三维角色的不同行为。

<div align=center>
<img src="https://i.imgur.com/EwJTkNf.png" width="80%">
</div>

### Per-vertex Animation

另一种实现三维动画的方法是利用网格的顶点来控制运动，这种技术称为**顶点动画(per-vertex animation)**。此时网格上的每个顶点有具有3个平移自由度，通过对网格顶点坐标的变换就可以实现模型的运动。这种动画方法在人物角色上的应用比较少，但在物理仿真中则相对比较常见。

<div align=center>
<img src="https://i.imgur.com/EgHxfOd.png" width="80%">
</div>

### Morph Target Animation

类似于顶点动画，**morph target animation**同样是利用顶点来控制模型的运动。和顶点动画不同的是，morph target animation不会直接操作网格顶点的坐标而是通过顶点的位置和权重来控制整个网格的行为。morph target animation在表现角色面部表情上有很广泛的应用。

<div align=center>
<img src="https://i.imgur.com/6pkkdzz.png" width="80%">
</div>

### Skinned Animation

本节课的核心是介绍**蒙皮动画(skinned animation)**的相关技术。蒙皮动画是目前游戏行业最主流的三维动画技术，它通过控制角色内部骨骼的运动来实现整个角色的运动。和刚体动画相比，蒙皮动画可以实现更加真实和自然的运动效果。

<div align=center>
<img src="https://i.imgur.com/njDSxGm.png" width="80%">
</div>

蒙皮动画同样可以应用在二维动画上。基于2D蒙皮动画的运动会比刚体动画有更加自然的表现效果。

<div align=center>
<img src="https://i.imgur.com/OEjHE1m.png" width="80%">
</div>

### Physics-based Animation

在蒙皮动画之外另一大类动画形式是**物理动画(physics-based animation)**。物理动画是完全基于物理法则的动画模拟方法，和蒙皮动画相比需要更加深入的数学物理知识进行描述。本课程中不会过多地介绍物理动画的相关内容。

<div align=center>
<img src="https://i.imgur.com/KrsywfT.png" width="80%">
</div>

### Animation Content Creation

如何获得动画呢？早期的解决方法是由动画师在软件中通过关键帧来对角色的动作进行建模，而目前越来越多的游戏和电影则是通过真人动捕来获得更加自然的运动动画。

<div align=center>
<img src="https://i.imgur.com/zroTBXC.png" width="80%">
</div>

## Skinned Animation Implementation

## Animation Compression

## Animation DCC

- [Lecture 08：Basics of Animation Technology I](https://www.bilibili.com/video/BV1jr4y1t7WR/?spm_id_from=333.788)