---
layout: article
title: Shape Analysis课程笔记08-Geodesic Distances Intro & Theory
tags: ["Shape Analysis", "CG"]
key: SA-08
aside:
  toc: true
sidebar:
  nav: SA
---

> 这个系列是[MIT 6.838: Shape Analysis](https://groups.csail.mit.edu/gdpgroup/6838_spring_2021.html)的同步课程笔记。本课程会介绍几何方法在图形学、机器学习、计算机视觉、医疗图像以及建筑设计等相关领域的原理和应用。本节主要介绍测地距离的基本概念。
<!--more-->

## Motivation

在接下来的几节课中我们会介绍如何计算曲面上点之间的距离。这里我们需要区分一下**intrinsic**和**extrinsic**的概念，intrinsic是指我们只能在曲面(流形)上进行移动，而extrinsic则允许离开曲面。以下图为例，两个猫爪之间的extrinsic距离非常小，而intrinsic距离则很大。

<div align=center>
<img src="https://i.imgur.com/ef2D7aP.png" width="80%">
</div>

曲面上的intrinsic距离也称为**测地距离(geodesic distance)**，它可以理解为限制在曲线上移动时两点之间的最短距离。

<div align=center>
<img src="https://i.imgur.com/gqpjjhM.png" width="80%">
</div>

计算测地距离并不简单。实际上距离函数可能有大量的**局部极小值(local minimum)**，这容易导致我们在计算时的效率比较低而且会不那么稳定。

<div align=center>
<img src="https://i.imgur.com/uANk5xe.png" width="80%">
<img src="https://i.imgur.com/MrOkJch.png" width="80%">
</div>

测地距离的另一大特点是它有很多相似的定义。这里需要说明的是尽管这些定义在欧式空间下是等价的，但在更一般的情况下往往是有区别的。

<div align=center>
<img src="https://i.imgur.com/TsxRHw1.png" width="80%">
</div>

计算测地距离的一种方法是把网格理解为一张图，然后使用图上的最短路径算法来求解。当网格非常稠密时顶点之间的最短路径是测地距离的一个很好的近似，但在大多数情况下测地距离都是严格小于最短路径长度的，而且这种近似方式会产生各种各样的问题。

<div align=center>
<img src="https://i.imgur.com/sPnovid.png" width="80%">
<img src="https://i.imgur.com/LZeE4X7.png" width="80%">
<img src="https://i.imgur.com/sIKxp3d.png" width="80%">
<img src="https://i.imgur.com/vndbech.png" width="80%">
<img src="https://i.imgur.com/7aqyADE.png" width="80%">
<img src="https://i.imgur.com/k1vIpwi.png" width="80%">
</div>

实际上可以严格证明图上的最短路径不会收敛到测地距离上，要计算测地距离还需要一些额外的处理。

<div align=center>
<img src="https://i.imgur.com/YhMh2K6.png" width="80%">
<img src="https://i.imgur.com/WljKutA.png" width="80%">
</div>

## Defining Geodesic Distance

### False Equivalences

测地距离有很多"等价"的定义，但需要注意的是它们之间是由严格区别的。最常见的定义是全局的最短路径，如下图中棕色路线所示；与之对应的是局部最短路径，由黄色路线表示；而另一个常见的定义则是局部最直的路径，由绿色路线表示。

<div align=center>
<img src="https://i.imgur.com/epjSfi6.png" width="80%">
</div>

### Derivative Formulas

回忆曲线[弧长](/2022/08/07/SA-NOTES-03.html#arc-length)的定义，我们首先利用全局最短曲线来定义测地线。

<div align=center>
<img src="https://i.imgur.com/VGQeadf.png" width="80%">
<img src="https://i.imgur.com/BDWC8ij.png" width="80%">
</div>

由于直接计算弧长比较麻烦，更常用的处理方法是使用曲线的能量$E[\gamma]=\int_a^b \Vert \gamma'(t) \Vert_2 \ dt$来代替弧长作为我们的优化函数。实际上能量$E[\gamma]$是弧长的一个上界，这里简单证明一下。设有实值函数$f, g: [a, b] \rightarrow \mathbb{R}$，我们定义函数的内积为：

$$
\langle f, g \rangle = \int_a^b f(t) g(t) \ dt
$$

根据**Cauchy-Schwarz不等式(Cauchy-Schwarz inequality)**有：

$$
\vert \langle f, g \rangle \vert \leq \Vert f \Vert_2 \ \Vert g \Vert_2
$$

$$
\Vert f \Vert_2^2 = \langle f, f \rangle
$$

因此有：

$$
\begin{aligned}
2(b-a) E &= (b-a) \int_a^b \Vert \gamma'(t) \Vert_2^2 \ dt \\
&= \bigg[ \int_a^b 1 \ dt \bigg] \bigg[ \int_a^b \Vert \gamma'(t) \Vert_2^2 \ dt \bigg] \\
&= \langle 1, 1\rangle \cdot \langle \Vert \gamma' \Vert_2, \Vert \gamma' \Vert_2 \rangle \\
&= \Vert 1 \Vert_2^2 \cdot \big\Vert \Vert \gamma' \Vert_2 \big\Vert_2^2 \\
&\geq \langle 1, \Vert \gamma' \Vert_2 \rangle^2 \\
&= \bigg[ \int_a^b \Vert \gamma' \Vert_2 \ dt \bigg]^2 \\
&= L^2[\gamma]
\end{aligned}
$$

当且仅当$\Vert \gamma' \Vert_2$为常数时不等式取等号。

<div align=center>
<img src="https://i.imgur.com/GWxD6ro.png" width="80%">
</div>

## Reference

- [Lecture 08：Geodesic distances](https://www.youtube.com/watch?v=r4H7H0km02Q&list=PLQ3UicqQtfNtUcdTMLgKSTTOiEsCw2VBW&index=11&ab_channel=JustinSolomon)
- [Chapter 6：Geodesic distances](https://groups.csail.mit.edu/gdpgroup/assets/6838_spring_2021/chapter6.pdf)