---
layout: article
title: Shape Analysis课程笔记07-Discrete Surface Curvature
tags: ["Shape Analysis", "CG"]
key: SA-07
aside:
  toc: true
sidebar:
  nav: SA
---

> 这个系列是[MIT 6.838: Shape Analysis](https://groups.csail.mit.edu/gdpgroup/6838_spring_2021.html)的同步课程笔记。本课程会介绍几何方法在图形学、机器学习、计算机视觉、医疗图像以及建筑设计等相关领域的原理和应用。本节主要介绍离散网格上计算各种曲率的相关方法。
<!--more-->

## Applications of Curvature

在上一节中我们介绍了连续曲面上的曲率。具体地，曲面上最重要的两个曲率分别是Gauss曲率和平均曲率，它们与主曲率以及曲面的第二基本形式有着密切的关系。

<div align=center>
<img src="https://i.imgur.com/DgKBaAO.png" width="80%">
</div>

曲面上的曲率在工程中有非常多的应用。比如说我们可以把Gauss曲率和平均曲率作为曲面形状的描述子、利用曲率来重建曲面、对曲面进行滤波、指导渲染过程、指导重新网格化(remeshing)等。

<div align=center>
<img src="https://i.imgur.com/i0WPFB7.png" width="80%">
<img src="https://i.imgur.com/WfbZ0k9.png" width="80%">
<img src="https://i.imgur.com/7G4JXqb.png" width="80%">
<img src="https://i.imgur.com/wTR3sBF.png" width="80%">
<img src="https://i.imgur.com/ekIdhLp.png" width="80%">
<img src="https://i.imgur.com/fEQIWiG.png" width="80%">
</div>

## Approximating Curvature

### Challenge on Meshes

在离散网格上计算曲率的难点在于曲率的定义依赖于曲面上的导数，而在离散网格上每个面片都是一个平面。因此对于离散曲面的曲率我们只能使用一些近似方法来计算。

<div align=center>
<img src="https://i.imgur.com/zQot69A.png" width="80%">
<img src="https://i.imgur.com/C2L30UV.png" width="80%">
</div>

### Local Tensor Methods

早期计算离散曲面上曲率的方法是直接估计网格上的第二基本形式，然后再导出Gauss曲率和平均曲率。Taubin指出在光滑曲面上可以利用一个矩阵来$M_\mathbf{p}$来估计曲率：

<div align=center>
<img src="https://i.imgur.com/JBPaeEw.png" width="80%">
</div>

进一步可以证明$M_\mathbf{p}$的特征向量分别为法向$\mathbf{n}$以及两个主方向$\mathbf{t}_1$和$\mathbf{t}_2$，而其特征值与曲面的主曲率密切相关：

<div align=center>
<img src="https://i.imgur.com/A7WyZzG.png" width="80%">
</div>

对于离散的情况，我们只需要把积分改成求和并替换掉相应的被积项即可：

<div align=center>
<img src="https://i.imgur.com/aFajK1V.png" width="80%">
<img src="https://i.imgur.com/Uotc8kO.png" width="80%">
</div>

这里我们简单对离散的过程进行一下推导。对于曲面上的曲线$\gamma(s)$，首先根据Taylor展开有：

$$
\gamma(s) = \mathbf{p} + \mathbf{T}(0) s + \frac{1}{2} \kappa_{\gamma(0)} \mathbf{N}(0) s^2 + O(s^3)
$$

上式表明：

$$
\Vert \gamma(s) - \mathbf{p} \Vert_2^2 = s^2 + O(s^3)
$$

$$
2 \mathbf{n}_\mathbf{p}^T (\gamma(s) - \mathbf{p}) = \kappa_{\theta} s^2 + O(s^3)
$$

因此可以得到方向曲率的计算公式：

$$
\begin{aligned}
\kappa_{\theta} &= \frac{2 \mathbf{n}_\mathbf{p}^T (\gamma(s) - \mathbf{p})}{s^2} + O(s) \\
&= \frac{2 \mathbf{n}_\mathbf{p}^T (\gamma(s) - \mathbf{p})}{\Vert \gamma(s) - \mathbf{p} \Vert_2^2 + O(s^3)} + O(s) \\
&= \frac{2 \mathbf{n}_\mathbf{p}^T (\gamma(s) - \mathbf{p})}{\Vert \gamma(s) - \mathbf{p} \Vert_2^2} + O(s)
\end{aligned}
$$

<div align=center>
<img src="https://i.imgur.com/4iS11Rh.png" width="80%">
</div>

Taubin方法的一个缺陷在于它对曲率的估计容易受到局部噪声的影响。由于Taubin方法是基于Taylor展开来推导的，当网格不够稠密时它对曲率的估计往往不够准确。

<div align=center>
<img src="https://i.imgur.com/EnzZmwW.png" width="80%">
</div>

## Reference

- [Lecture 07：Approximating Gaussian/mean/principal curvatures on triangle meshes](https://www.youtube.com/watch?v=2vtxIOOMV_A&list=PLQ3UicqQtfNtUcdTMLgKSTTOiEsCw2VBW&index=10&ab_channel=JustinSolomon)
- [Chapter 5：Curvature](https://groups.csail.mit.edu/gdpgroup/assets/6838_spring_2021/chapter5.pdf)