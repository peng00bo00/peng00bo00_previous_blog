---
layout: article
title: DDG课程笔记2-曲面与曲率
tags: ["DDG", "CG"]
key: DDG-2
aside:
  toc: true
sidebar:
  nav: DDG
---

> 这个系列是对CMU离散微分几何课程([CMU CS 15-458/858: Discrete Differential Geometry](https://brickisland.net/DDGSpring2021/))的总结和回顾。有了外代数和外微分的基础以后，接下来我们开始讨论曲面和曲率的一些性质。
<!--more-->

## Surfaces

### Parameterized Surface

对于三维空间中的曲面，我们可以把它看成是二维平面通过映射$f: M \rightarrow \mathbb{R}^3$嵌入到三维空间中，这样的曲面称为**参数化曲面(Parameterized Surface)**。映射$f$描述了二维平面如何在三维空间中进行"伸展"，对$f$进行微分就可以把平面向量$X$映射到空间中得到对应的切向量$df(X)$，换句话说$df$告诉了我们平面如何在局部进行了"伸展"。

<div align=center>
<img src="https://i.imgur.com/OMcsivK.png" width="70%">
</div>

将$df$写成矩阵的形式就得到了$f$对应的Jacobi矩阵(Jacobian matrix):

$$
df(X) = J_f X
$$

$$
J_f = 
\begin{bmatrix}
    \frac{\partial f^1}{\partial x^1} & \cdots & \frac{\partial f^1}{\partial x^n} \\
    \vdots                            & \ddots & \vdots \\
    \frac{\partial f^n}{\partial x^1} & \cdots & \frac{\partial f^n}{\partial x^n} \\
\end{bmatrix}
$$

当曲面通过$f$进行变换时可能会遇到一些退化的情况，比如说我们可以定义$f$把平面映射到球面：

$$
f(u, v) = (\cos (u) \sin (v), \sin (u) \sin (v), \cos (v))
$$

$$
\begin{aligned}
df = &(-\sin (u) \sin (v), & & \cos (u) \sin (v), & &0 & &) & & du + \\ &(\cos (u) \cos (v), & &\cos (v) \sin (u), & &-\sin (v) & &) & &dv
\end{aligned}
$$

<div align=center>
<img src="https://i.imgur.com/vDWiiF3.png" width="60%">
</div>

$f$相当于用地图来表示地球表面，$u$方向对应东西方向而$v$方向对应南北方向。当$v=0$我们会位于球面北极的位置，此时取$X=(1, 0)$得到$df(X) = (0, 0, 0)$。也就是说沿$X$方向前进我们始终会留在原地，换句话说我们没有办法在两极定义东西方向。

为了避免上述这种退化问题同时方便后面的分析和推导这里引入immersed surface的概念：定义$f: U \rightarrow \mathbb{R}^n$是一个immersion当且仅当$df$不会退化，即$df(X) \vert_p = 0 \Leftrightarrow X \vert_p = 0$。在本课程中除非特殊说明我们均假定$f$是一个immersion。

### Induced Metric

对于参数化曲面我们总是希望可以在参数平面上研究曲面的在空间中的性质，比如说角度、长度、面积等等。以角度为例，显然参数平面上向量$X$和$Y$的夹角并不代表映射到空间后两个方向上的夹角。此外，对于同一个曲面可能存在多个不同的参数化方法，因此参数平面上向量的夹角并没有告诉我们任何关于曲面自身的信息。

<div align=center>
<img src="https://i.imgur.com/iKSfblF.png" width="50%">
</div>

尽管参数平面上向量的夹角没有什么特殊的意义，但通过微分映射$df$我们可以把参数平面上的向量转换到曲面的切平面上，从而得到曲面的信息。具体地我们定义切平面上$df(X)$和$df(Y)$的内积为：

$$
g(X, Y) = \langle df(X), df(Y) \rangle
$$

称$g$为$f$的**诱导度量(induced metric)**。将参数平面上的任意两个向量$X$和$Y$带入诱导度量得到：

$$
g(X, Y) = \langle df(X), df(Y) \rangle = (J_f X)^T (J_f Y) = X^T J_f^T J_f Y = X^T \mathbf{I} Y
$$

其中$\mathbf{I} = J_f^T J_f$称为曲面的**第一基本型(first fundamental form)**。

第一基本型完全描述了曲面的度量性质，我们可以以此计算曲面上的夹角、长度、面积等几何量。

### Normals

除了切向量外我们往往还关心曲面的法向量。我们定义**高斯映射(Gauss Map)**为参数平面上的点到对应单位法向量的映射。显然单位法向量到在单位球面上，因此高斯映射也可以看做是参数平面到单位球上的映射。

<div align=center>
<img src="https://i.imgur.com/8ZzJZxw.png" width="50%">
</div>

我们还可以定义区域内的平均法向：

$$
\frac{1}{A(\Omega)} \int_\Omega N dA
$$

其中被积项$N dA$为大小等于面积微元的法向量，称为**vector area**。

我们将differential 2-form的运算法则推广到向量，用向量叉乘$\times$代替标量乘法可以得到：

$$
\begin{aligned}
df \wedge df (X, Y) &= df(X) \times df(Y) - df(Y) \times df(X) \\
&= 2 df(X) \times df(Y) \\
&= 2 N dA(X, Y)
\end{aligned}
$$

即$N dA = \frac{1}{2} df \wedge df$，再根据Stokes定理得到：

$$
2 \int_\Omega N dA = \int_\Omega df \wedge df = \int_\Omega d (f df) = \int_{\partial \Omega} f df
$$

上式表明对于给定的映射$f$，具有相同边界的的曲面会拥有相同的vector area；同时也表明对于封闭曲面其平均法向为0。

<div align=center>
<img src="https://i.imgur.com/Oor6vho.png" width="70%">
</div>

### Discrete Surfaces

本节的最后来讨论一下曲面的离散表示。目前空间曲面最常用的表达形式仍然是三角网格，三角网格的连接关系表示曲面的拓扑信息，而网格顶点的坐标则表达了曲面的几何信息。

如果我们忽略网格的几何信息仅考虑拓扑关系，我们也可以把网格看做是一个**流形(manifold)**。那么接下来的问题是如何把流形嵌入到空间中？很显然我们可以构造顶点坐标的函数$f$将平面网格映射到空间中。也就是说我们只需要知道网格和映射$f$就足以表示空间曲面了。

<div align=center>
<img src="https://i.imgur.com/oOX5rDU.png" width="35%">
</div>

离散曲面的优势在于曲面的每个面片都是平面，因此我们之前在$\mathbb{R}^n$推导的公式仍然是有效的。实际上，我们之前推导的所有离散微分算子都可以直接应用到离散曲面上而无需任何额外的处理；此外我们在推导时也没有考虑任何的几何关系，也就是说我们可以仅依赖于拓扑关系就可以对网格进行处理。

## Smooth Curvature

### Curvature of Curves

接下来介绍曲率相关的知识，首先来考虑光滑曲线的曲率。类似于参数平面，我们可以把曲线看成是直线$L$经过映射$\gamma$嵌入到平面（空间）中，此时称$\gamma(t)$为一条参数化曲线：

<div align=center>
<img src="https://i.imgur.com/wXh7MUH.png" width="70%">
</div>

显然对于同一条给定的曲线存在不同的参数化方法，其中最重要的一种参数化是使用曲线的弧长作为参数，称为**弧长参数化(arc-length parameterized)**：

$$
s = s(t) = \int_0^t \lVert \dot \gamma(t) \rVert dt
$$

对于使用弧长参数化的空间曲线，曲线上的每一点都对应着一个局部坐标系称为**Frenet标架(Frenet frame)**，对应的三个坐标轴分别为切向$T$、法向$N$和从法向$B$：

- $T(s) = \frac{d}{ds} \gamma(s)$
- $N(s) = \frac{d}{ds} T(s)$
- $B(s) = T(s) \times N(s)$

<div align=center>
<img src="https://i.imgur.com/ncvyAuO.png" width="25%">
</div>

可以证明使用弧长参数化时曲线的切向量长度为1，因此三个坐标轴对应的向量均为单位向量。同时三个向量还满足**Frenet-Serret公式(Frenet–Serret formulas)**：

$$
\frac{d}{ds}
\begin{bmatrix}
T \\ N \\ B
\end{bmatrix}
=
\begin{bmatrix}
0 & \kappa & 0 \\
-\kappa & 0 & \tau \\
0 & -\tau & 0
\end{bmatrix}

\begin{bmatrix}
T \\ N \\ B
\end{bmatrix}
$$

其中$\kappa = \langle N, \frac{d}{ds}T \rangle$描述了切向的变化率，称为**曲率(curvature)**；$\tau = -\langle N, \frac{d}{ds}B \rangle$描述了从法向的变化率，称为**挠率(torsion)**。

此外我们还可以考虑曲面上的曲线：设曲线上一点的曲面法向为$N_M$、从法向为$B_M = T \times N_M$，定义曲线的**法曲率(normal curvature)**$\kappa_n$和**测地曲率(geodesic curvature)**$\kappa_g$：

$$
\kappa_n = \langle N_M, \frac{d}{ds}T \rangle
$$

$$
\kappa_g = \langle B_M, \frac{d}{ds}T \rangle
$$

<div align=center>
<img src="https://i.imgur.com/zboyfRW.png" width="40%">
</div>

法曲率代表曲线为了维持在曲面上所具有的曲率，而测地曲率则描述了曲线偏离测地线的程度。

<div align=center>
<img src="https://i.imgur.com/3s48mMg.png" width="40%">
</div>

### Curvature of Surfaces

## Discrete Curvature

### Scalar Curvature

### Curvature Normals

### Variational Viewpoint

### Curvature Flow

## Reference

- [CHAPTER 3: A Quick and Dirty Introduction to Differential Geometry](http://www.cs.cmu.edu/~kmcrane/Projects/DDG/paper.pdf#page=29)
- [CHAPTER 5: Curvature of Discrete Surfaces](http://www.cs.cmu.edu/~kmcrane/Projects/DDG/paper.pdf#page=85)
- [Discrete Curvatures and Normals](https://geometrycollective.github.io/geometry-processing-js/projects/discrete-curvatures-and-normals/index.html)
- [Wikipedia: First fundamental form](https://en.wikipedia.org/wiki/First_fundamental_form)
- [Wikipedia: Frenet–Serret formulas](https://en.wikipedia.org/wiki/Frenet%E2%80%93Serret_formulas)