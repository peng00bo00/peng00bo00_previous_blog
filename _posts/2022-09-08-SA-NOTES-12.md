---
layout: article
title: Shape Analysis课程笔记12-The Laplacian Operator
tags: ["Shape Analysis", "Geometry Processing", "CG"]
key: SA-12
aside:
  toc: true
sidebar:
  nav: SA
---

> 这个系列是[MIT 6.838: Shape Analysis](https://groups.csail.mit.edu/gdpgroup/6838_spring_2021.html)的同步课程笔记。本课程会介绍几何方法在图形学、机器学习、计算机视觉、医疗图像以及建筑设计等相关领域的原理和应用。本节主要介绍Laplace算子的相关概念。
<!--more-->

**Laplace算子(Laplacian operator)**在数学和物理等相关领域中有着大量的应用。在几何处理中，我们可以利用Laplace算子将几何形状变换到频域然后从频谱的角度进行分析，这样的方法称为**spectral geometry**。

<div align=center>
<img src="https://i.imgur.com/3ow9HlK.png" width="80%">
<img src="https://i.imgur.com/vigcdRI.png" width="80%">
</div>

在本节课中我们会从简单的情况入手逐渐揭示Laplace算子在不同几何对象上的意义和应用。

<div align=center>
<img src="https://i.imgur.com/aDAWhdC.png" width="80%">
</div>

不过在具体介绍Laplace算子之前我们先回忆一下[线性算子](/2022/08/04/SA-NOTES-02.html#two-roles-for-matrices)的概念。当算子满足分配律和数乘时就称其是一个线性算子，我们常见的矩阵就是一个典型的线性算子。

<div align=center>
<img src="https://i.imgur.com/z4PEqlU.png" width="80%">
</div>

使用线性算子的一个优势在于我们可以不再受限于空间的维度，线性算子可以自然地推广到无穷维的空间上。

<div align=center>
<img src="https://i.imgur.com/wEVLGL2.png" width="80%">
</div>

同时矩阵的谱定理对于线性算子也有相应的推广。

<div align=center>
<img src="https://i.imgur.com/4U4MOPn.png" width="80%">
</div>

## Line Segments

### 1D Spring Network

首先考虑一维的情况。假设有一维质点弹簧系统，其中每个质点的质量为$m$，质点数为$n+1$，弹簧刚度为$k$。我们固定两端质点使其无法移动，

<div align=center>
<img src="https://i.imgur.com/kN691J5.png" width="80%">
</div>

根据牛顿运动定律，每个质点的运动方程可以表示为：

$$
\begin{aligned}
F &= m \cdot a = m \cdot \frac{d^2 u_i}{d t^2} \\
&= k (u_{i+1} - u_i) + k (u_{i-1} - u_i) \\
&= k (u_{i+1} + u_{i-1} - 2 u_i)
\end{aligned}
$$

整理之后可以得到线性系统：

$$
U'' (t) = -k L \ U(t)
$$

$$
L = 
\begin{bmatrix}
 2 &-1 \\
-1 & 2 &-1 \\ 
   &   & \ddots & \\
   &   &     -1 & 2 &-1 \\
   &   &        &-1 & 2
\end{bmatrix}
$$

对于微分项我们使用差分来进行近似：

$$
\frac{d^2 u}{d x^2} \approx \frac{\frac{u_{i+1} - u_i}{h} - \frac{u_i - u_{i-1}}{h}}{h}
= \frac{u_{i+1} + u_{i-1} - 2u_i}{h^2}
$$

这样线性算子$L$可以理解为求二阶导数：

$$
L \approx - \frac{d^2}{d x^2}
$$

此时求解运动方程相当于求解**偏微分方程(PDE)**：

$$
\frac{\partial^2 U}{\partial t^2} = c^2 \ \frac{d^2 U}{d x^2}
$$

上式即为**一维波动方程(wave equation)**，它描述了质点系统的振动。

<div align=center>
<img src="https://i.imgur.com/o8Tx6q5.png" width="80%">
</div>

波动方程更常见的形式为：

$$
\frac{\partial^2 u}{\partial t^2} - \frac{\partial^2 u}{\partial x^2} = 0
$$

<div align=center>
<img src="https://i.imgur.com/H0YWVf4.png" width="80%">
</div>

### Minus Second Derivative Operator

我们定义算子$L[\cdot]: u \rightarrow - \frac{\partial^2 u}{\partial x^2}$，可以证明它是一个(半)正定算子。

<div align=center>
<img src="https://i.imgur.com/vvlKdeq.png" width="80%">
</div>

对于离散的情况，$L$即为上面定义的矩阵。对于任意向量$u$有：

$$
\begin{aligned}
u^T L u &= \sum_i u_i (Lu)_i \\
&= \sum_i u_i (-u_{i-1} + 2 u_i - u_{i+1}) \\
&= 2 \sum_i u_i^2 - 2 \sum_i u_{i} u_{i-1} \\
&= \sum_i u_i^2 + \sum_i u_{i-1}^2 - 2 \sum_i u_{i} u_{i-1} \\
&= \sum_i (u_i - u_{i-1})^2 \\
&\geq 0
\end{aligned}
$$

而对于连续的情况则有：

$$
\begin{aligned}
\langle u, L[u] \rangle &= \int_a^b u(x) \cdot - \bigg( \frac{\partial^2 u}{\partial x^2}  \bigg) \ dx \\
&= \bigg[ - \frac{\partial u}{\partial x} \cdot u \bigg]_a^b + \int_a^b \frac{\partial u}{\partial x} \cdot \frac{\partial u}{\partial x} \ dx \\
&= \int_a^b \bigg( \frac{\partial u}{\partial x} \bigg)^2 \ dx \\
&\geq 0
\end{aligned}
$$

<div align=center>
<img src="https://i.imgur.com/IAQW26p.png" width="80%">
</div>

### Eigenfuctions of Second Derivative Operator

除了半正定外，在连续情况下算子$L$还有类似于矩阵特征向量的概念，称为**特征函数(eigenfunction)**。容易验证$L$的特征函数和对应特征值为：

$$
\phi_k (x) = \sqrt{\frac{2}{l}} \sin \bigg( \frac{\pi k x}{l} \bigg)
$$

$$
\lambda_k = \bigg( \frac{\pi k}{l} \bigg)^2
$$

而且不同特征函数之间是相互正交的：

$$
\langle \phi_k, \phi_m \rangle = \delta_{km}
$$

<div align=center>
<img src="https://i.imgur.com/52FzrMt.png" width="80%">
</div>

利用特征向量(函数)的正交性，我们可以对位移向量(函数)进行分解。对于离散情况，根据谱定理有：

$$
U(t) = \sum_i U^i(t) \phi_i
$$

其中$U^i(t)$为随时间变化的系数。带入微分方程可以得到：

$$
\begin{aligned}
\sum_i (U^i)'' (t) \ \phi_i &= -k L \ \sum_i U^i(t) \ \phi_i \\
&= -k \ \sum_i U^i(t) \ \lambda_i \phi_i
\end{aligned}
$$

进一步有：

$$
(U^i)'' (t) = -k \ U^i(t) \ \lambda_i
$$

因此我们只需要求解$n$个**常微分方程(ODE)**就可以得到波动方程的解。具体地，每个常微分方程的解为：

$$
U^i (t) = a^i \sin (\sqrt{k \lambda_i} t) + b^i \cos (\sqrt{k \lambda_i} t)
$$

这表示我们可以通过$L$矩阵的特征值与特征向量来计算波动方程的闭式解，而对于连续的情况也有类似的结论。

<div align=center>
<img src="https://i.imgur.com/ro3sunj.png" width="80%">
</div>

## Regions in $\mathbb{R}^n$

## Graphs

## Surfaces/Manifolds

## Reference

- [Lecture 12-13：The Laplacian operator on intervals, regions, graphs, and manifolds](https://www.youtube.com/watch?v=VZMZUeIVUuA&list=PLQ3UicqQtfNtUcdTMLgKSTTOiEsCw2VBW&index=16)
- [Lectures 13 (extra content): Divergence of tangent vector fields](https://www.youtube.com/watch?v=7hTd6aVfAvQ&list=PLQ3UicqQtfNtUcdTMLgKSTTOiEsCw2VBW&index=17)
- [The Laplacian Operator](https://groups.csail.mit.edu/gdpgroup/assets/6838_spring_2021/8_laplacian_operator.pdf)
- [Chapter 9：The Laplacian Operator](https://groups.csail.mit.edu/gdpgroup/assets/6838_spring_2021/chapter9.pdf)