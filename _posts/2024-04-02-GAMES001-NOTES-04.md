---
layout: article
title: GAMES001课程笔记04-奇异值分解与主成分分析
tags: ["CG", "GAMES001", "Math"]
key: GAMES001-04
aside:
  toc: true
sidebar:
  nav: GAMES001
---

> 这个系列是GAMES001-图形学中的数学([GAMES 001: Mathematics in Computer Graphics](https://games-cn.org/games001/))的同步课程笔记。课程旨在总结归纳图形学学习过程中重要的数学概念、理论和方法，并将以索引的形式在每一章节中穿插讲解该数学专题在图形学中的应用。本课程既可以作为GAMES系列其它课程学习的基础或"手册"，也可以作为站在不一样的视角复习图形学知识的平台。本节主要介绍奇异值分解与主成分分析的相关内容。
<!--more-->

## 奇异值分解

矩阵有很多不同的理解方式。在[前面](/2024/03/09/GAMES001-NOTES-01.html#矩阵-1)的课程中我们提到过矩阵可以理解为一种线性变换，除此之外矩阵还可以表示一张图片或是点云这种几何数据。因此我们可以从不同的视角来理解矩阵变换的各种意义。

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/6lLbPZz.png" width="100%">
</div>

**奇异值分解(singular value decomposition, SVD)**是一种对矩阵进行分析和处理的重要计算，它在数学和整个计算机科学领域都有着重要的应用。

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/NSuGlk3.png" width="100%">
</div>

### 实对称矩阵

我们从实对称矩阵出发。根据线性代数相关理论，实对称矩阵具有如下重要性质：

- 实对称矩阵的特征值都是实数。
- 实对称矩阵不同特征值的特征向量相互正交。

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/uQMpd4C.png" width="100%">
</div>

在此基础上我们可以得到实对称矩阵的特征值分解：

$$
S = Q \Lambda Q^T = 
\begin{pmatrix}
q_0 & \dots & q_{n-1}
\end{pmatrix}
\begin{pmatrix}
\lambda_0 & & \\
& \ddots & \\
& & \lambda_{n-1}
\end{pmatrix}
\begin{pmatrix}
q_0^T \\ \vdots \\ q_{n-1}^T
\end{pmatrix}
$$

其中，特征值$$\lambda_i$$有正有负，且非零特征值的个数等于矩阵的秩$$r = \text{rank} (S)$$。

如果$$S$$的所有特征值都是非负的，则称它是一个**半正定(semi-positive definite, SPD)**矩阵。对于半正定矩阵，我们可以定义实对角矩阵$$\Sigma$$：

$$
\Sigma = 
\begin{pmatrix}
\sqrt{\lambda_0} & & \\
& \ddots & \\
& & \sqrt{\lambda_{n-1}}
\end{pmatrix}
$$

显然它满足$$\Sigma^2 = \Lambda$$。这样就可以定义实对称矩阵的平方根$$P$$：

$$
S = Q \Lambda Q^T = Q \Sigma^2 Q^T = (Q \Sigma Q^T)(Q \Sigma Q^T) = P^2
$$

$$
P = S^{\frac{1}{2}}
$$

此外，容易验证实对称矩阵的迹等于其特征值之和：

$$
\text{Tr} (S) = \text{Tr} (\Lambda) = \sum_i \lambda_i
$$

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/KTOJTLU.png" width="100%">
</div>

### 奇异值分解

对于一个更一般的矩阵$$A \in \mathbb{R}^{m \times n}$$，其秩为$$r$$，我们定义一个新的矩阵$$S$$：

$$
S = A^T A
$$

显然$$S$$是一个实对称半正定矩阵。对$$S$$进行特征值分解，可以得到$$r$$个特征向量$$\{ v_i \}$$构成一组正交基：

$$
S v_i = \lambda_i v_i
$$

两边同时乘以特征向量$$v_j$$可以得到：

$$
v_i^T S v_j = v_i^T A^T A v_j = \lambda_j v_i^T v_j = \lambda_j \delta_{ij}
$$

接下来定义向量$$u_i = \frac{1}{\sqrt{\lambda_i}} A v_i$$，容易验证$$\{ u_i \}$$构成一组正交基：

$$
\begin{aligned}
u_i^T u_j &= \bigg( \frac{1}{\sqrt{\lambda_i}} A v_i \bigg)^T \bigg( \frac{1}{\sqrt{\lambda_j}} A v_j \bigg) \\
&= \frac{1}{\sqrt{\lambda_i \lambda_j}} v_i^T A^T A v_j \\
&= \delta_{ij}
\end{aligned}
$$

通过Schmidt正交化可以分别对$$\{ v_i \}$$和$$\{ u_i \}$$进行扩充，从而得到$$\mathbb{R}^n$$和$$\mathbb{R}^m$$上的正交基。其中扩充的基满足：

$$
\sqrt{\lambda_i} u_j = A v_j = 0
$$

这样两组基的关系写成矩阵形式有：

$$
A V = U \Sigma
$$

其中，$$V$$和$$U$$都是正交矩阵。

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/sC3v7xw.png" width="100%">
</div>

上面的推导即为矩阵的奇异值分解，其更常见的形式为：

$$
A = U \Sigma V^T
$$

其中，矩阵$$A$$为一个任意m×n维矩阵(不需要是方阵，也不需要满秩)；$$U$$和$$V$$分别是$$\mathbb{R}^{m \times m}$$和$$\mathbb{R}^{n \times n}$$的正交矩阵；$$\Sigma$$是$$$$\mathbb{R}^{m \times n}$$$$的"对角"矩阵，其对角元均是非负数称为矩阵$$A$$的奇异值。

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/RlV6RQv.png" width="100%">
</div>

矩阵的奇异值分解是线性代数中的重要概念。当矩阵的奇异值分解已知时，我们可以快速地求解矩阵相关的各种问题。

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/2gYnnj8.png" width="100%">
</div>

### 伪逆

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/Ho1SUqm.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/OmndFrM.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/6j0Av8z.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/hirGR0d.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/ki1qCOT.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/7cT4lc1.png" width="100%">
</div>

### 几何变换

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/vTPnpJV.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/LzIWjtH.png" width="100%">
</div>

### 形状匹配

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/f5Ww0fq.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/EWbEgrz.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/MYm4WxF.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/kCrmrp7.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/gdMU3zK.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/RcUHqWy.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/WxOvqLh.png" width="100%">
</div>

### 图像压缩

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/yH8H6nd.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/NmyenAo.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/lOcMktF.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/TfJALUa.png" width="100%">
</div>

### SVD求导

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/DnLjzrO.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/2biKeSq.png" width="100%">
</div>

<div align=center>
<img src="https://search.pstatic.net/common?src=https://i.imgur.com/aN31ErM.png" width="100%">
</div>

## 主成分分析

## Reference

- [Lecture 05: 奇异值分解与主成分分析](https://www.bilibili.com/video/BV1MF4m1V7e3?p=5&vd_source=7a2542c6c909b3ee1fab551277360826)