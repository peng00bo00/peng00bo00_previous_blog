---
layout: article
title: Shape Analysis课程笔记17-Optimization on Manifolds
tags: ["CG", "Geometry Processing", "Shape Analysis"]
key: SA-17
aside:
  toc: true
sidebar:
  nav: SA
---

> 这个系列是[MIT 6.838: Shape Analysis](https://groups.csail.mit.edu/gdpgroup/6838_spring_2021.html)的同步课程笔记。本课程会介绍几何方法在图形学、机器学习、计算机视觉、医疗图像以及建筑设计等相关领域的原理和应用。本节主要介绍流形上的优化问题。
<!--more-->

## Optimization with a Manifold Constraint

在机器学习和计算机视觉中很多问题都可以建模为在流形上进行处理的优化问题。

<div align=center>
<img src="https://i.imgur.com/pOr7PYN.png" width="80%">
</div>

三维重建中对相机姿态的优化就是典型的例子：相机的旋转矩阵并不是任意的矩阵，它需要满足正交阵的约束。

<div align=center>
<img src="https://i.imgur.com/QDJ7kBQ.png" width="80%">
</div>

**冷冻电镜(Cryo-EM)**在重建分子的结构时也会遇到类似的问题。

<div align=center>
<img src="https://i.imgur.com/iYX9OAg.png" width="80%">
</div>

而对于如何优化传感器的布置，我们同样可以把它表示为一个优化问题，此时传感器的布置形式在刚体变换下是相互等价的。

<div align=center>
<img src="https://i.imgur.com/0o9mvS7.png" width="80%">
</div>

## Manifold Optimization Algorithms

### Typical Approach

在过去，处理这些问题的经典方法是把流形上的优化变量嵌入到高维空间中，然后通过求解高维的约束优化问题。比如说三维空间的旋转构成李群SO(3)，在优化旋转时可以先不考虑李群的条件直接优化一个3×3的矩阵，然后再旋转矩阵作为约束。

<div align=center>
<img src="https://i.imgur.com/MyyhGnR.png" width="80%">
</div>

然而这种处理方法的缺陷在于它往往会具有非常复杂的表达形式，使得求解过程变得非常困难。

<div align=center>
<img src="https://i.imgur.com/4y3dHrl.png" width="80%">
</div>

从几何上来看，求解这样的约束优化问题相当于在红色曲线上进行移动直到找到优化目标$f$的最优解。此时我们可以通过投影的方式进行处理，即先忽略约束直接求解无约束优化然后把找到的解投影到约束空间中。

<div align=center>
<img src="https://i.imgur.com/ovDs0hO.png" width="80%">
<img src="https://i.imgur.com/VdkyadX.png" width="80%">
</div>

当然投影过程往往也并不容易，尤其是在约束条件比较复杂的时候。

<div align=center>
<img src="https://i.imgur.com/L3oK0S1.png" width="80%">
</div>

### Instrinsic Perspective

因此更现代的处理方法是结合流形自身的结构，利用流形自身的性质来进行求解。

<div align=center>
<img src="https://i.imgur.com/CidP5EK.png" width="80%">
<img src="https://i.imgur.com/rzyhVV2.png" width="80%">
</div>

从更高的视角来看这样的方法相当于直接在流形上进行优化，从而无需考虑复杂的约束条件。

<div align=center>
<img src="https://i.imgur.com/IrCj1eC.png" width="80%">
</div>

### Gradient Descent

<div align=center>
<img src="https://i.imgur.com/75Y25Cg.png" width="80%">
</div>

## Reference

- [Lecture 18: Optimization on manifolds; retractions](https://www.youtube.com/watch?v=2mnqWES2roQ&list=PLQ3UicqQtfNtUcdTMLgKSTTOiEsCw2VBW&index=25)
- [Lecture 18 (extra content): Manifold optimization for PCA problems](https://www.youtube.com/watch?v=hiqIj5jJdbk&list=PLQ3UicqQtfNtUcdTMLgKSTTOiEsCw2VBW&index=26)
- [Optimization on Manifolds](https://groups.csail.mit.edu/gdpgroup/assets/6838_spring_2021/12_manifold_optimization.pdf)