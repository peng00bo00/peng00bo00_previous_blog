---
layout: article
title: PBRT读书笔记02-Color and Radiometry
tags: ["PBRT", "Rendering", "CG"]
key: PBRT-02
aside:
  toc: true
sidebar:
  nav: PBRT
---

> 这个系列是[Physically Based Rendering:From Theory To Implementation](https://pbr-book.org/)的读书笔记，本节主要介绍辐射度量学的相关内容。
<!--more-->

## Radiometry

**辐射度量学(radiometry)**是利用数学工具来研究电磁辐射强弱的学科。在图形学中我们利用辐射度量学来精确描述光线如何进行传播和反射，同时我们还忽略了光的波动性质从而简化计算。PBRT基于几何光学对光线的性质进行了如下假设：

1. **线性(linearity)**：两个光学系统共同作用的效果等于它们分别作用的和
2. **能量守恒(energy conservation)**：当光线发生散射时不会带来新的能量
3. **没有极性(no polarization)**：不考虑电磁场的极性，只考虑光线在不同波长上的分布
4. **没有荧光/磷光(No fluorescence or phosphorescence)**：不同波长之间相互独立
5. **稳态(steady state)**：环境中的光场已经达到了平衡

### Basic Quantities

接下来介绍辐射度量学中常见的各种物理量。

#### Energy

最基本的物理量是**能量(energy)**，它的单位是焦耳(J)，用$Q$来表示。波长为$\lambda$的**光子(photon)**具有的能量为：

$$
Q = \frac{h c}{\lambda}
$$

其中$c$为光速，而$h$为普朗克常数。

#### Flux

接下来定义单位时间内接收到的能量为**flux**或**power**，用$\Phi$来表示：

$$
\Phi = \lim_{\Delta t \to 0} \frac{\Delta Q}{\Delta t} = \frac{d Q}{d t}
$$

flux的单位是瓦特(W)。我们对flux进行积分就可以得到能量：

$$
Q = \int_{t_1}^{t_2} \Phi(t) \ dt
$$

#### Irradiance

单位面积上接收到的flux称为**irradiance**，它的单位是W/m<sup>2</sup>：

$$
E = \frac{\Phi}{A}
$$

对于点光源，在光线传播过程中不同半径上的球面上irradiance为：

$$
E = \frac{\Phi}{4 \pi r^2}
$$

<div align=center>
<img src="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Flux%20on%20spheres.svg" width="30%">
</div>

我们同样可以对irradiance积分来获得flux：

$$
\Phi = \int_A E(p) \ d A
$$

关于irradiance还需要注意的一点是它与光线入射的角度相关。如果光线垂直入射则可以直接使用前面的公式计算：

$$
E_1 = \frac{\Phi}{A_1}
$$

如果光线的方向与平面法向存在夹角则需要将$\Phi$投影到法向上：

$$
E_2 = \frac{\Phi \cos{\theta}}{A_2}
$$

<div align=center>
<img src="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Lamberts%20Law.svg" width="40%">
</div>

#### Solid Angle and Intensity

在更进一步的讨论前我们还需要引入**立体角(solid angle)**的概念。立体角是平面角度在球面上的推广，它定义为球面上面积除以球面半径的平方，同时也等于物体投影到单位球面后投影区域的面积：

$$
\Omega = \frac{A}{r^2}
$$

显然整个球面的立体角为$4 \pi$ sr，半球面的立体角为$2 \pi$ sr。

<div align=center>
<img src="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Solid%20angle.svg" width="40%">
</div>

对于点光源我们定义在单位立体角上单位时间内发射的能量为：

$$
I = \frac{\Phi}{4 \pi}
$$

$I$称为**intensity**(W/sr)。同样地，我们可以对立体角进行积分来获得功率：

$$
\Phi = \int_\Omega I(\omega) \ d \omega
$$

#### Radiance

接下来我们介绍辐射度量学中最重要的物理量radiance，记为$L$。radiance表示在$\omega$方向上的单位立体角和垂直此方向的单位面积上的flux：

$$
L = \frac{\Phi}{d \omega \ d A^\perp}
$$

<div align=center>
<img src="https://pbr-book.org/3ed-2018/Color_and_Radiometry/Radiance.svg" width="40%">
</div>

#### Incident and Exitant Radiance Functions

## Reference

- [5 Color and Radiometry](https://pbr-book.org/3ed-2018/Color_and_Radiometry)
- [Lecture 15: Ray Tracing 3](https://www.bilibili.com/video/BV1X7411F744?p=15)