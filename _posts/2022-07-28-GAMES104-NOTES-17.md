---
layout: article
title: GAMES104课程笔记17-Advanced Artificial Intelligence
tags: ["GAMES104", "CG"]
key: GAMES104-17
aside:
  toc: true
sidebar:
  nav: GAMES104
---

> 这个系列是GAMES104-现代游戏引擎：从入门到实践([GAMES 104: Modern Game Engine-Theory and Practice](https://games104.boomingtech.com/en/))的同步课程笔记。本课程会介绍现代游戏引擎所涉及的系统架构、技术点以及引擎系统相关的知识。本节课主要介绍游戏AI的高级技术。
<!--more-->

## Hierarchical Tasks Network

**层次任务网络(hierarchical tasks network, HTN)**是经典的游戏AI技术，和上一节介绍过的行为树相比HTN可以更好地表达AI自身的意志和驱动力。

<div align=center>
<img src="https://i.imgur.com/4I7FBkU.png" width="80%">
</div>

HTN的思想是把总体目标分解成若干个步骤，其中每个步骤可以包含不同的选项。AI在执行时需要按照顺序完成每个步骤，并且根据自身的状态选择合适的行为。

<div align=center>
<img src="https://i.imgur.com/WTmq3fH.png" width="80%">
</div>

### HTN Framework

HTN框架中包含两部分，**world state**和**sensor**两部分。其中world state是AI对于游戏世界的认知，而sensor则是AI从游戏世界获取信息的渠道。

<div align=center>
<img src="https://i.imgur.com/PzwkQex.png" width="80%">
</div>

除此之外HTN还包括**domain**，**planner**以及**plan runner**来表示AI的规划以及执行规划的过程。

<div align=center>
<img src="https://i.imgur.com/NIgzWmt.png" width="80%">
</div>

### HTN Task Types

在HTN中我们将任务分为两类，**primitive task**和**compound task**。

<div align=center>
<img src="https://i.imgur.com/WHd8iWK.png" width="80%">
</div>

primitive task一般表示一个具体的动作或行为。在HTN中每个primitive task需要包含precondition、action以及effects三个要素。

<div align=center>
<img src="https://i.imgur.com/8e2Rubm.png" width="80%">
<img src="https://i.imgur.com/7LbXg9S.png" width="80%">
</div>

而compound task则包含不同的方法，我们把这些方法按照一定的优先级组织起来并且在执行时按照优先级高到低的顺序进行选择。每个方法还可以包含其它的primitive task或者compound task，当方法内所有的task都执行完毕则表示任务完成。

<div align=center>
<img src="https://i.imgur.com/uyiZZfx.png" width="80%">
<img src="https://i.imgur.com/0AM4PCH.png" width="80%">
</div>

在此基础上就可以构造出整个HTN的domain，从而实现AI的行为逻辑。

<div align=center>
<img src="https://i.imgur.com/Jak3o9O.png" width="80%">
<img src="https://i.imgur.com/gpnKV0x.png" width="80%">
</div>

### Planning

接下来就可以进行规划了，我们从root task出发不断进行展开逐步完成每个任务。

<div align=center>
<img src="https://i.imgur.com/6wDGpPe.png" width="80%">
<img src="https://i.imgur.com/jGFZOQn.png" width="80%">
<img src="https://i.imgur.com/8e1rE9T.png" width="80%">
<img src="https://i.imgur.com/ZeuFXIu.png" width="80%">
<img src="https://i.imgur.com/CULPkyw.png" width="80%">
<img src="https://i.imgur.com/yjPOnj9.png" width="80%">
<img src="https://i.imgur.com/Kiq24df.png" width="80%">
</div>

### Replan

执行plan时需要注意有时任务会失败，这就需要我们重新进行规划，这一过程称为**replan**。

<div align=center>
<img src="https://i.imgur.com/l1qMknL.png" width="80%">
</div>

当plan执行完毕或是发生失败，亦或是world state发生改变后就需要进行replan。

<div align=center>
<img src="https://i.imgur.com/rFOzkJ1.png" width="80%">
</div>

总结一下HTN和BT非常相似，但它更加符合人的直觉也更易于设计师进行掌握。

<div align=center>
<img src="https://i.imgur.com/wzusHJq.png" width="80%">
</div>

## Goal-Oriented Action Planning

## Monte Carlo Tree Search

## Machine Learning Basic

## Build Advanced Game AI

## Reference

- [Lecture 17：Advanced Artificial Intelligence (Part I)](https://www.bilibili.com/video/BV1iG4y1i78Q?spm_id_from=333.337.search-card.all.click&vd_source=7a2542c6c909b3ee1fab551277360826)
- [Lecture 17：Advanced Artificial Intelligence (Part II)](https://www.bilibili.com/video/BV1ja411U7zK/?spm_id_from=333.788&vd_source=7a2542c6c909b3ee1fab551277360826)