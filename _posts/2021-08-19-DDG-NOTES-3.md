---
layout: article
title: DDG课程笔记3-Laplace算子
tags: ["DDG", "CG"]
key: DDG-3
aside:
  toc: true
sidebar:
  nav: DDG
---

> 这个系列是对CMU离散微分几何课程([CMU CS 15-458/858: Discrete Differential Geometry](https://brickisland.net/DDGSpring2021/))的总结和回顾。本节我们介绍几何处理中最实用的工具-Laplace算子。
<!--more-->

## Overview

**Laplace算子(Laplacian)**在不同的领域里都有非常重要的应用。在物理学中我们可以通过Laplace算子来描述不同的物理现象：

<div align=center>
<img src="https://i.imgur.com/mF7mk2s.png" width="80%">
</div>

在几何处理中Laplace算子描述了网格的局部信息，因此也称为微分坐标(differential coordinates)。同时，Laplace算子也和平均曲率以及网格的频率信息有着紧密的联系：

<div align=center>
<img src="https://i.imgur.com/kVsi4Sa.png" width="80%">
</div>

欧式空间中的Laplace算子可以定义为函数二阶导数的和：

$$
\Delta u = \sum_{i=1}^n \frac{\partial^2 u}{\partial x_i^2}
$$

因此Laplace算子描述了函数在局部邻域内的性质，我们可以通过Laplace算子来计算函数的极值点以及曲率：

<div align=center>
<img src="https://i.imgur.com/SKszyKt.png" width="40%">
<img src="https://i.imgur.com/oSa7sBw.png" width="40%">
</div>

在图论中，Laplace算子则描述了节点和它相邻节点平均值的相对关系：

$$
(L u)_i = \big( \frac{1}{\text{deg}(i)} \sum_{ij \in E} u_j \big) - u_i
$$

在社交网络中这表示每一个人总是与和他相关的人具有相似的属性（观点）。

<div align=center>
<img src="https://i.imgur.com/eO9Hsga.png" width="30%">
</div>

### Definitions

尽管Laplace算子在不同的领域中有着不同的定义，我们可以看出Laplace算子描述了一个对象和它相邻对象平均值的关系。同时，针对Laplace算子的不同性质也可以给出很多等价的定义。考虑Laplace算子可以看做是偏导数的和，这里给出Laplace算子在流形上的定义：

$$
\Delta u = \sum_{i=1}^n \sum_{j=1}^n \frac{1}{\sqrt{\det (g)}} \frac{\partial}{\partial x_i} \Big( \sqrt{\det (g)} (g^{-1})_{ij} \frac{\partial}{\partial x_j} u \Big)
$$

<div align=center>
<img src="https://i.imgur.com/NcFdnqU.png" width="35%">
</div>

可以验证在欧式空间下上式会退化为我们熟悉的二阶导数和的形式$\Delta u = \sum_{i=1}^n \frac{\partial^2 u}{\partial x_i^2}$。尽管这个式子十分复杂，在实际的计算中基本不会直接使用它。

对函数$u$进行泰勒展开并保留到二阶得到：

$$
u(x_0 + w) \approx u(x_0) + \langle \nabla u(x_0), w \rangle + \frac{1}{2} \langle \nabla^2 u(x_0) w, w \rangle
$$

<div align=center>
<img src="https://i.imgur.com/R3QMvci.png" width="70%">
</div>

不难发现Laplace算子等于Hessian矩阵的迹：

$$
\Delta u = \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} = \text{tr} (\nabla^2 u)
$$

在曲面上使用**协变导数(covariant derivative)**来代替欧式坐标中的导数，得到：

$$
\nabla_{X, Y}^2 u (X, Y) = (\nabla_X du) (Y)
$$

此时Laplace算子仍然等于Hessian矩阵的迹：

$$
\Delta u = \text{tr}(\nabla^2 u) = \text{tr}(\nabla du)
$$

Laplace算子还可以定义为梯度的散度，此时表达式为：

$$
\Delta u = \nabla \cdot \nabla u
$$

<div align=center>
<img src="https://i.imgur.com/qkmJKuW.png" width="41%">
<img src="https://i.imgur.com/UG2lS4F.png" width="30%">
</div>

此外，我们还可以通过随机游走(**布朗运动(Brownian motion)**)来认识Laplace算子。对于单一粒子的随机游走其状态可由热传导方程进行刻画，带入初始条件$\phi$得到：

$$
\left\{
\begin{aligned}
&\frac{d}{dt} u = \Delta u \\
&u \vert_{t=0}  = \phi
\end{aligned}
\right.

\Rightarrow

u(t, x) = \int_\Omega k_t(x, y) \phi(y) dy = \mathbb{E}[\phi (X_t)]
$$

其中$k_t(x, y)$称为**热核(heat kernel)**，表示从具有单位温度的热源$x$经时间$t$传播到$y$处时的温度，这里可以认为是粒子从$x$出发在$t$时刻位于$y$的概率密度；$X_t$表示随机游走的粒子在$t$时刻的位置。


最后来介绍Laplace算子与**Dirichlet能量(Dirichlet energy)**的关系。定义Dirichlet能量为：

$$
E(u) = \int_M \vert \nabla u \vert^2 dV
$$

<div align=center>
<img src="https://i.imgur.com/afz2P6S.png" width="40%">
</div>

Dirichlet能量描述了函数的光滑程度：Dirichlet能量越小表示函数越光滑、变化越平稳；Dirichlet能量越大表示函数越粗糙、变化越剧烈。同时可以证明最小化Dirichlet能量相当于求解Laplace方程：

$$
u = \arg \min_u E(u) \Leftrightarrow \Delta u = 0
$$

### Properties

## Discretization via DEC

## Applications

## Reference

- [CHAPTER 6: The Laplacian](http://www.cs.cmu.edu/~kmcrane/Projects/DDG/paper.pdf#page=101)
- [Laplace-Beltrami: The Swiss Army Knife of Geometry Processing](http://ddg.cs.columbia.edu/SGP2014/LaplaceBeltrami.pdf)