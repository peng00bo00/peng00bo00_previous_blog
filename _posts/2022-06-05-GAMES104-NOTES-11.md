---
layout: article
title: GAMES104课程笔记11-Applications in Physics System
tags: ["GAMES104", "CG"]
key: GAMES104-11
aside:
  toc: true
sidebar:
  nav: GAMES104
---

> 这个系列是GAMES104-现代游戏引擎：从入门到实践([GAMES 104: Modern Game Engine-Theory and Practice](https://games104.boomingtech.com/en/))的同步课程笔记。本课程会介绍现代游戏引擎所涉及的系统架构、技术点以及引擎系统相关的知识。本节课主要介绍游戏引擎中物理系统的应用以及一些高级算法。
<!--more-->

## Character Controller

**角色控制器(character controller)**是玩家操作角色和游戏世界进行交互的接口。和很多人直观的认识不同，角色控制器在很多情况下实际上是一个非物理的。最常见的例子是玩家控制角色停止移动时角色会立即停住，而不是严格按照刚体仿真那样通过摩擦力来逐渐停止运动。某种意义上讲，角色控制器虽然是反物理的但却更符合人对物理世界的认知。

<div align=center>
<img src="https://i.imgur.com/x6NYW7E.png" width="80%">
<img src="https://i.imgur.com/wgAbEwW.png" width="80%">
</div>

### Build a Controller in Physics System

在构建角色控制器时一般会使用简化后的形状来包裹角色，这样便于处理各种场景之间的互动。

<div align=center>
<img src="https://i.imgur.com/KflUJE2.png" width="80%">
</div>

### Collide with Environment

在角色和场景进行互动时最常见的情况是玩家控制的角色撞到了墙壁上。如果严格按照物理引擎进行模拟，此时角色会一直停在碰撞的位置；而现代游戏中更常见的处理方式是修改角色的运动方向，使得角色可以沿墙壁方向进行滑动。

<div align=center>
<img src="https://i.imgur.com/WkqxvJj.png" width="80%">
</div>

### Auto Stepping

上下楼梯同样也是角色在场景中的一种常见行为。如果严格按照物理仿真进行处理，胶囊的上下楼梯会非常地困难。因此在游戏引擎中需要单独考虑这种情况，当角色上下楼梯时自动修正角色的位置。

<div align=center>
<img src="https://i.imgur.com/LpIReRH.png" width="80%">
</div>

对于斜坡这种情况，如果按照刚体运动学进行处理会导致角色下坡时直接从斜坡上滑下来，或是在上坡时由于具有过大的速度角色直接冲上它不应该到达的位置。为了避免这些问题需要单独考虑角色停在斜坡或是限制角色的位置。

<div align=center>
<img src="https://i.imgur.com/HD0H4EI.png" width="80%">
</div>

### Controller Volume Update

角色控制器还需要考虑角色体积发生变化的情况。当玩家控制角色进行下蹲等动作时需要自动更新角色控制体的体积，否则容易出现角色卡在门口无法进入的问题。

<div align=center>
<img src="https://i.imgur.com/i9mL6Br.png" width="80%">
</div>

### Controller Push Objects

当玩家控制角色和场景中的物体互动时需要对动态对象的运动状态加以更新。比较常见的处理方式是发生碰撞时对动态对象施加一个相应的冲量来控制它们的运动。

<div align=center>
<img src="https://i.imgur.com/HjTnDFv.png" width="80%">
</div>

### Standing on Moving Platform

除此之外，角色控制器还需要考虑动态场景的情况。当角色位于运动的平台时需要根据平台的运动来调整角色的运动状态，否则会出现平台发生运动时角色的运动没有同步或是滞后的问题。

<div align=center>
<img src="https://i.imgur.com/hORYId3.png" width="80%">
</div>

## Ragdoll

## Destruction

## Cloth

## Vehicle

## Advanced: PBD/XPBD

## Reference

- [Lecture 11：Physics System – Applications](https://www.bilibili.com/video/BV1Ya411j7ds/?spm_id_from=333.788)