---
layout: article
title: GAMES103课程笔记02-Math Background
tags: ["GAMES103", "CG"]
key: GAMES103-02
aside:
  toc: true
sidebar:
  nav: GAMES103
---

> 这个系列是GAMES103：基于物理的计算机动画入门([GAMES 103: Intro to Physics
Based Animation](http://games-cn.org/games103/))的同步课程笔记。本课程将作为基于物理的计算机动画技术入门，着重介绍各种基础的物理动画模拟技术。本节课主要复习相关的数学知识。
<!--more-->

## Vector

### Definition

对物理系统的模拟离不开线性代数的相关知识，因此我们从最基础的**向量(vector)**开始复习。在图形学中向量一般默认是指三维向量，它表示空间点$\mathbf{p}$的坐标：

$$
\mathbf{p} = 
\begin{bmatrix}
p_x \\ p_y \\ p_z
\end{bmatrix}
\in \mathbb{R}^3
$$

在大多数的教材和论文中都会默认我们的坐标系是右手系，但需要注意的是在某些库和引擎中可能会使用左手系(如Unity、DirectX等)。

<div align=center>
<img src="https://i.imgur.com/bD0IG7R.png" width="70%">
</div>

### Addition and Subtraction

向量的基本运算是加法和减法，此时我们只需要将对应位置坐标相加减即可：

$$
\mathbf{p} \pm \mathbf{q} = \mathbf{q} \pm \mathbf{p} =
\begin{bmatrix}
p_x \pm q_x \\ p_y \pm q_y \\ p_z \pm q_z
\end{bmatrix}
\in \mathbb{R}^3
$$

从几何的角度上看，向量的加减实际上就是平行四边形法则：

<div align=center>
<img src="https://i.imgur.com/4uxxD41.png" width="70%">
</div>

我们可以利用向量的加减法来表示点的运动。假设空间中点在0时刻的位置为$\mathbf{p}$并以速度$\mathbf{v}$进行运动，则$t$时刻$\mathbf{p}$点在$t$时刻的位置为：

$$
\mathbf{p} (t) = \mathbf{p} + t \mathbf{v}
$$

类似地，我们也可以利用向量加减法来表示直线。经过点$\mathbf{p}$和点$\mathbf{q}$的直线可以表示为：

$$
\begin{aligned}
\mathbf{p} (t) &= \mathbf{p} + t (\mathbf{q} - \mathbf{p}) \\
&= (1 - t) \mathbf{p} + t \mathbf{q}
\end{aligned}
$$

当$0 \leq t \leq 1$时$\mathbf{p} (t)$位于线段$\mathbf{pq}$上；当$t \gt 1$或$t \lt 0$时$\mathbf{p} (t)$位于线段$\mathbf{pq}$外。从这个角度上看，$\mathbf{p} (t)$实际上是对$\mathbf{p}$和$\mathbf{q}$的位置进行了一个线性插值。

<div align=center>
<img src="https://i.imgur.com/Ie3KRCS.png" width="70%">
</div>

### Vector Norm

我们可以通过**范数(norm)**来度量向量的大小，常用的范数包括：

- 2-norm：$$\Vert p \Vert_2 = (p_x^2 + p_y^2 + p_z^2)^\frac{1}{2}$$
- 1-norm：$$\Vert p \Vert_1 = \vert p_x \vert + \vert p_y \vert + \vert p_z \vert$$
- p-norm：$$\Vert p \Vert_p = (\vert p_x \vert^p + \vert p_y \vert^p + \vert p_z \vert^p)^\frac{1}{p}$$
- infinity norm：$$\Vert p \Vert_\infty = \max \{ \vert p_x \vert, \vert p_y \vert, \vert p_z \vert \}$$

通过范数我们就可以度量$\mathbf{p}$和$\mathbf{q}$之间的距离$\Vert \mathbf{p} - \mathbf{q} \Vert$。同时范数为1的向量称为**单位向量(unit vector)**，对于任意非零的向量我们可以通过**规范化(normalization)**来将它转换成单位向量：

$$
\mathbf{\bar p} = \frac{\mathbf{p}}{\Vert \mathbf{p} \Vert}
$$

<div align=center>
<img src="https://i.imgur.com/ug5yIub.png" width="70%">
</div>

### Dot Product

**点乘运算(dot product)**或者说**内积运算(inner product)**将两个向量映射成标量：

$$
\begin{aligned}
\mathbf{p} \cdot \mathbf{q} &= p_x q_x + p_y q_y + p_z q_z \\
&= \mathbf{p}^T \mathbf{q} \\
&= \Vert \mathbf{p} \Vert \Vert \mathbf{q} \Vert \cos \theta
\end{aligned}
$$

从几何上看向量之间的点乘等价于它们的模长之积乘以它们夹角的余弦：

<div align=center>
<img src="https://i.imgur.com/nistl5L.png" width="30%">
</div>

点乘运算的常用性质如下：

- 交换律：$$\mathbf{p} \cdot \mathbf{q} = \mathbf{q} \cdot \mathbf{p}$$
- 结合律：$$\mathbf{p} \cdot (\mathbf{q} + \mathbf{r}) = \mathbf{q} \cdot \mathbf{p} + \mathbf{q} \cdot \mathbf{r}$$
- 模长：$$\mathbf{p} \cdot \mathbf{p} = \Vert p \Vert_2^2$$
- 对于非零向量$\mathbf{p}$和$\mathbf{q}$，$$\mathbf{p} \cdot \mathbf{q} = 0 \iff \mathbf{p} \perp \mathbf{q}$$

通过点乘运算我们可以完成很多相对复杂的任务。假设我们想要计算$\mathbf{oq}$在$\mathbf{v}$方向上的投影，首先可以利用点乘得到$\mathbf{oq}$在$\mathbf{v}$方向上投影的长度：

$$
\begin{aligned}
s &= \Vert \mathbf{q} - \mathbf{o} \Vert \cos \theta \\
&= \frac{\Vert \mathbf{q} - \mathbf{o} \Vert \Vert v \Vert \cos \theta}{\Vert v \Vert} \\
&= \frac{(\mathbf{q} - \mathbf{o}) \cdot \mathbf{v}}{\Vert v \Vert} \\
&= (\mathbf{q} - \mathbf{o}) \cdot \mathbf{\bar v}
\end{aligned}
$$

因此投影坐标为：

$$
\mathbf{s} = \mathbf{o} + s \mathbf{\bar v}
$$

<div align=center>
<img src="https://i.imgur.com/n8Pb0IM.png" width="30%">
</div>

类似地，假设平面的法向为$\mathbf{n}$，我们可以利用点乘来判断$\mathbf{p}$点与平面的相对位置关系：

$$
s = (\mathbf{p} - \mathbf{c}) \cdot \mathbf{n}
$$

若$s \gt 0$表示$\mathbf{p}$点在平面上方；若$s \lt 0$表示$\mathbf{p}$点在平面下方；若$s = 0$则表示$\mathbf{p}$点在平面上。

<div align=center>
<img src="https://i.imgur.com/gDNdHz9.png" width="30%">
</div>

最后一个例子，我们可以利用点乘来判断$\mathbf{p}$点在运动过程中是否与圆盘$\mathbf{c}$相交。假设$t$时刻$\mathbf{p}$点到圆心的距离恰好为$r$：

$$
\Vert \mathbf{p}(t) - \mathbf{c} \Vert^2 = \Vert \mathbf{p} + t \mathbf{v} - \mathbf{c} \Vert^2 = r^2
$$

整理方程可以得到关于时间$t$的二元一次方程：

$$
(\mathbf{v} \cdot \mathbf{v}) t^2 + 2 (\mathbf{p} - \mathbf{c}) \cdot \mathbf{v} t + (\mathbf{p} - \mathbf{c}) \cdot (\mathbf{p} - \mathbf{c}) - r^2 = 0
$$

因此我们就可以通过这个方程根的数目来判断$\mathbf{p}$点是否与圆盘相交。

<div align=center>
<img src="https://i.imgur.com/cyeEund.png" width="30%">
</div>

### Cross Product

**叉乘运算(cross product)**也是一种常用的向量乘法，它定义为：

$$
\mathbf{r} = \mathbf{p} \times \mathbf{q} = 
\begin{bmatrix}
p_y q_z - p_z q_y \\
p_z q_x - p_x q_z \\
p_x q_y = p_y q_x \\
\end{bmatrix}
$$

从几何上看，$\mathbf{r}$是一个垂直于$\mathbf{p}$和$\mathbf{q}$的向量，它的模长等于两个向量模长之积乘以它们夹角的正弦：

$$
\Vert \mathbf{r} \Vert = \Vert \mathbf{p} \Vert \Vert \mathbf{q} \Vert \sin \theta
$$

<div align=center>
<img src="https://i.imgur.com/DP7z3wt.png" width="30%">
</div>

叉乘运算的常用性质如下：

- 垂直性：$$\mathbf{r} \cdot \mathbf{p} = \mathbf{r} \cdot \mathbf{q} = 0$$
- 反交换性：$$\mathbf{p} \times \mathbf{q} = \mathbf{q} \times \mathbf{p}$$
- 结合律：$$\mathbf{p} \times (\mathbf{q} + \mathbf{r}) = \mathbf{q} \times \mathbf{p} + \mathbf{q} \times \mathbf{r}$$
- 对于非零向量$\mathbf{p}$和$\mathbf{q}$，$$\mathbf{p} \times \mathbf{q} = 0 \iff \mathbf{p} \varparallel \mathbf{q}$$

## Matrix