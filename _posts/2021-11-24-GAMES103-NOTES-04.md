---
layout: article
title: GAMES103课程笔记04-Rigid Contacts
tags: ["GAMES103", "CG"]
key: GAMES103-04
aside:
  toc: true
sidebar:
  nav: GAMES103
---

> 这个系列是GAMES103：基于物理的计算机动画入门([GAMES 103: Intro to Physics Based Animation](http://games-cn.org/games103/))的同步课程笔记。本课程是计算机动画的入门课程，着重介绍各种基于物理的动画仿真模拟技术。本节课主要介绍刚体的碰撞与接触。
<!--more-->

## Particle Collision

### Signed Distance Function

空间中的曲面可以使用**有向距离函数(signed distance function, SDF)**来表示。根据距离函数$\phi(\mathbf{x})$的符号我们可以表示质点$\mathbf{x}$在曲面外侧、曲面内侧或是曲面上：

<div align=center>
<img src="https://i.imgur.com/PxisizC.png" width="70%">
</div>

常见规则曲面的SDF如下图所示：

<div align=center>
<img src="https://i.imgur.com/pq5UA0b.png" width="70%">
</div>

使用SDF来表示曲面的好处之一在于它可以高效地表示质点与多个曲面的位置关系。假设我们有3个曲面$\phi_0$、$\phi_1$、$\phi_2$，当质点$\mathbf{x}$位于3个曲面内部时它到最近曲面的距离为：

$$
\phi (\mathbf{x}) = \max \{ \phi_0(\mathbf{x}), \phi_1(\mathbf{x}), \phi_2(\mathbf{x}) \}
$$

$$
\phi_i (\mathbf{x}) \lt 0
$$

<div align=center>
<img src="https://i.imgur.com/6SFYltv.png" width="30%">
</div>

换句话说我们只需要计算若干个距离函数就可以判断质点是否与曲面发生碰撞，这就为碰撞检测带来了便利。

当然需要说明的是当质点位于曲面并集构成的区域中$(\phi_i (\mathbf{x}) \lt 0)$时使用上式的计算结果是不精确的：

$$
\phi(\mathbf{x}) \approx \max\{\phi_0 (\mathbf{x}), \phi_0 (\mathbf{x}) \}
$$

但是如果$\mathbf{x}$位于曲面外侧$(\phi_i (\mathbf{x}) \gt 0)$则可以精确计算质点到曲面的距离：

$$
\phi(\mathbf{x}) = \min \{\phi_0 (\mathbf{x}), \phi_0 (\mathbf{x}) \}
$$

<div align=center>
<img src="https://i.imgur.com/0E6st2p.png" width="25%">
</div>

### Penalty Method

碰撞仿真的基本方法是利用SDF进行碰撞检测，当质点进入曲面内部时施加一个反方向的力来把它推出去，这样的方法称为**penalty method**：

<div align=center>
<img src="https://i.imgur.com/vwsUSfx.png" width="70%">
</div>

施加推力时可以把它想象成弹簧，这样力的大小就和压缩的距离成正比，力的方向为$\phi(\mathbf{x})$的梯度方向。显然这样的方法容易造成穿模的问题，因此实际使用时往往还需要设计一个安全距离$\varepsilon$，只要质点进入了安全距离内就施加推力：

<div align=center>
<img src="https://i.imgur.com/sODnBUi.png" width="70%">
</div>

然而这样方法存在一个问题，当弹簧系数$k$比较大时会产生过于巨大的推力。因此实践中也会使用距离的对数来对$k$进行近似，这样当距离很小的时候才会产生非常大的推力。但需要说明的是这种方法在质点发生穿模时会产生吸力，在实际应用中必须要调整实践步长$\Delta t$来避免这种情况的发生。

<div align=center>
<img src="https://i.imgur.com/KbY2nX0.png" width="70%">
</div>


### Impulse Method

## Rigid Body Collision

## Shape Matching

## Reference