---
layout: article
title: GAMES301课程笔记05-全局单射参数化方法
tags: ["CG", "GAMES301", "Geometry Processing"]
key: GAMES301-05
aside:
  toc: true
sidebar:
  nav: GAMES301
---

> 这个系列是GAMES301-曲面参数化([GAMES 301: Surface Parameterization](http://staff.ustc.edu.cn/~renjiec/GAMES301/index.html))的同步课程笔记。课程内容涉及曲面参数化的基本理论与问题描述、面向离散网格的参数化、基于基函数表示的连续参数化、共形参数化、曲面参数化的应用等。本节课主要介绍全局单射参数化方法。
<!--more-->

在前面的课程中介绍了无翻转曲面参数化的常用思想和技术。除了没有翻转外，我们往往还会对参数化的过程引入更多的[约束](/2022/10/14/GAMES301-NOTES-02.html#constraints)。比如说我们希望参数化是一个**全局单射(global injective)**，此时参数平面上不会出现任何自交和相互覆盖的情况。

<div align=center>
<img src="https://i.imgur.com/kzbdHrr.png" width="80%">
<img src="https://i.imgur.com/WDolXN4.png" width="80%">
</div>

类似于[初始无翻转](/2022/10/19/GAMES301-NOTES-04.html)情况的参数化，计算全局单射时往往也会从Tutte'e embedding出发。此时的初始化结果是无翻转也没有重叠的，然后通过优化几何扭曲的方式来获得所需的参数化。当然在迭代的过程中除了保证没有翻转外还需要保证在边界上没有自交。

<div align=center>
<img src="https://i.imgur.com/cyc8tpK.png" width="80%">
</div>

## Barriers

为了保证参数化的结果没有翻转和自交，我们可以为优化目标函数设置一个**障碍函数(barrier function)**。当网格上趋向于出现自交时会产生一个巨大的惩罚项从而避免三角形进一步退化。由于全局单射是由参数化后的边界控制的，因此我们可以为网格边界设置一个障碍函数。当边界上出现自交时一定存在顶点$U_i$穿过了三角形的一条边$U_1 U_2$，因此我们可以利用点到直线的距离作为障碍函数：

$$
E_{ev} (\mathbf{b}_j, \mathbf{x}_i) = \max \bigg( 0, \frac{\varepsilon}{D(\mathbf{b}_j, \mathbf{x}_i)} -1 \bigg)^2
$$

其中函数$D(\mathbf{b}_j, \mathbf{x}_i)$度量了顶点到边的距离，而参数$\varepsilon$则控制了二者之间的最小间隔。

<div align=center>
<img src="https://i.imgur.com/W1d3hEP.png" width="80%">
</div>

此时整体的优化目标函数可以表示为几何扭曲项$E_d (\mathcal{M}, \mathcal{\hat{M}})$与障碍函数$E_b (\mathcal{B})$之和。我们可以使用前面介绍过的各种优化求解器来进行求解。

<div align=center>
<img src="https://i.imgur.com/ZDzwJkB.png" width="80%">
</div>

<div align=center>
<img src="https://i.imgur.com/YjJCm7U.png" width="80%">
</div>

## Scaffold

**scaffold**方法的思想在于为原始网格$\mathcal{M}$设计一个辅助网格$\mathcal{S}$，通过对整个网格$\mathcal{G} = (\mathcal{M}, \mathcal{S})$构造无翻转的参数化来保证原始网格$\mathcal{M}$不会出现自交。这样相当于去掉了无自交的约束，只需考虑整体网格上无翻转即可。

<div align=center>
<img src="https://i.imgur.com/Wm8dWsZ.png" width="80%">
</div>

在优化整体网格$\mathcal{G}$上的扭曲时有时还会同步更新辅助网格$\mathcal{S}$上的连接关系。这样可以避免辅助网格出现退化，也能够提升参数化后原始网格$\mathcal{M}$的质量。

<div align=center>
<img src="https://i.imgur.com/OwnQFj7.png" width="80%">
</div>

<div align=center>
<img src="https://i.imgur.com/XsF9NnQ.png" width="80%">
</div>

## Combined

<div align=center>
<img src="https://i.imgur.com/ssoYxoO.png" width="80%">
</div>

<div align=center>
<img src="https://i.imgur.com/93tOTXN.png" width="80%">
</div>

## Reference

- [Lecture 05：全局单射参数化方法](https://www.bilibili.com/video/BV18T411P7hT?p=5&vd_source=7a2542c6c909b3ee1fab551277360826)