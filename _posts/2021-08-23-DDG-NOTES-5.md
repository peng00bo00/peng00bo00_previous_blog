---
layout: article
title: DDG课程笔记5-测地线
tags: ["DDG", "CG"]
key: DDG-5
aside:
  toc: true
sidebar:
  nav: DDG
---

> 这个系列是对CMU离散微分几何课程([CMU CS 15-458/858: Discrete Differential Geometry](https://brickisland.net/DDGSpring2021/))的总结和回顾。本节我们介绍基曲面上测地线与测地距离的相关内容。
<!--more-->

## Overview

**测地线(geodesics)**可以看做是直线在完全空间中的推广，基于欧式空间中直线的性质我们可以得到测地线的两条基本性质：

- **straightest**: (局部)没有弯曲；
- **shortest**: (局部)距离最短；

同时，测地线还是一个**等距变换下的不变量(isometry invariant)**。比如说人身体上任意两点之间的测地线不会因为人体的动作而发生改变。

<div align=center>
<img src="https://i.imgur.com/RXaND8O.png" width="50%">
</div>

日常生活中最常见的测地线应该是飞机的航线。对于地球上的任意两点之间，它们之间的最短路线是这两点与球心构成的圆弧。如果我们把航线映射到地图上则可以发现此时的测地线并不是两点之间的直线，这充分体现了欧式空间与曲面的差异。

<div align=center>
<img src="https://i.imgur.com/vhxcp6z.png" width="70%">
</div>

<div align=center>
<img src="https://i.imgur.com/NiLEv16.png" width="70%">
</div>

从测地线的两条基本性质出发我们可以对离散曲面上的测地线做出不同的定义。稍后能看到尽管在光滑曲面上这些定义是相互等价的，但在离散后它们之间可能会有一定的差异。

## Shortest Path

### Dirichlet Energy on Curves

我们首先把测地线定义为两点之间的最短路径。对于平面上的给定两点存在通过它们的参数化曲线$\gamma(t): [0, 1] \rightarrow \mathbb{R}^2$，则它对应的Dirichlet能量为：

$$
E_D(\gamma) = \int_0^1 \vert \gamma'(t) \vert^2 dt
$$

对$\gamma(t)$使用弧长参数进行重参数化，重新参数化后的曲线$\hat{\gamma}\big( c(t) \big)$关于弧长参数$c$的导数(速度)始终为1，因此：

$$
E_D(\gamma) = \int_0^1 \big( c'(t) \big)^2 dt
$$

重新参数化后最小化Dirichlet能量等价于最小化$\big( c'(t) \big)^2$的积分：

$$
\min_\gamma E_D(\gamma) = \min_{\hat{\gamma}} \Bigg( \min_c \int_0^1 \big( c'(t) \big)^2 dt \Bigg)
$$

此时最小化曲线$\gamma(t)$的Dirichlet能量转换为最小化曲线$c(t)$的Dirichlet能量。由于参数$c$满足条件$c(0)=0$，$c(1)=L$，因此Dirichlet能量在$c(t)$为直线时取最小值，即

$$
\min_\gamma E_D(\gamma) = \min_{\hat{\gamma}} \Bigg( \min_c \int_0^1 \big( c'(t) \big)^2 dt \Bigg) = \min_{\hat{\gamma}} L^2
$$

上式说明对于平面曲线，最小化Dirichlet能量等价于最小化曲线长度。显然此时最小化Dirichlet能量的曲线为连接端点的直线。

<div align=center>
<img src="https://i.imgur.com/xIKXmNM.png" width="30%">
<img src="https://i.imgur.com/IrzZIV1.png" width="35%">
</div>

利用Dirichlet能量的性质可以将Dirichlet能量改写为二阶导数内积的形式：

$$
\min_\gamma \int_0^1 \vert \gamma'(t) \vert^2 dt = \min_\gamma -\int_0^1 \langle \gamma(t), \gamma''(t) \rangle dt
$$

优化目标取极值的条件为二阶导数恒为0，得到一维Laplace方程：

$$
\begin{aligned}
\frac{\partial^2}{\partial t^2} \gamma(t) &= 0 \\
\gamma(0) &= p \\
\gamma(1) &= q
\end{aligned}
$$

我们称满足Laplace方程的函数为**调和函数(harmonic functions)**，同时上面的推导说明测地线为满足边界条件的调和函数。对于二维平面的情况可以验证直线方程为调和函数，因此测地线为连接端点的直线。

将平面曲线推广到曲面上的曲线，可以得到曲面上的Dirichlet能量为：

$$
E_D(\gamma) = \int_0^1 \vert \gamma'(t) \vert^2 dt = \int_0^1 g\big( \gamma'(t), \gamma'(t) \big) dt
$$

其中$g$为曲面的黎曼度量。显然我们可以通过在曲面上求解Laplace方程来获得测地线，但需要注意的是求解Laplace方程得到的测地线仅为Dirichlet能量的极小值点。实际上满足Laplace方程的曲线可能大多数都是局部最小值点或是鞍点，有时甚至可能会出现没有全局最小的情况。

<div align=center>
<img src="https://i.imgur.com/iDy9c9D.png" width="40%">
</div>

## Straightest Path

## Heat Method

## Reference
- [The Heat Method for Distance Computation](http://www.cs.cmu.edu/~kmcrane/Projects/HeatMethod/index.html)
- [HEAT METHODS IN GEOMETRY PROCESSING](http://helper.ipam.ucla.edu/publications/glws1/glws1_15468.pdf)
- [Geodesic Distance](https://geometrycollective.github.io/geometry-processing-js/projects/geodesic-distance/index.html)